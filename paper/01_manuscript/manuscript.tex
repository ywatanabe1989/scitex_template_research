%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-27 22:21:42 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/base.tex"
\UseRawInputEncoding

%% ----------------------------------------
%% SETTINGS
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/latex_styles/columns.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-30 18:04:38 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/shared/latex_styles/columns.tex"

%% --- Columns ---
%% \documentclass[final,3p,times,twocolumn]{elsarticle} %% Use it for submission
%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}
\documentclass[preprint,review,12pt]{elsarticle}

%%%% EOF


%% ========================================
%% ./01_manuscript/contents/latex_styles/packages.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-30 17:57:49 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/shared/latex_styles/packages.tex"
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-27 16:01:16 (ywatanabe)"

%% Language and encoding
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

%% Mathematics
\usepackage{amsmath, amssymb, amsthm}
\usepackage{siunitx}
\sisetup{round-mode=figures,round-precision=3}

%% Graphics and figures
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{pgfplots, pgfplotstable}
\usetikzlibrary{positioning,shapes,arrows,fit,calc,graphs,graphs.standard}

%% Tables
\usepackage[table]{xcolor}
\usepackage{booktabs, colortbl, longtable, supertabular, tabularx, xltabular}
\usepackage{csvsimple, makecell}

%% Table formatting
\renewcommand\theadfont{\bfseries}
\renewcommand\theadalign{c}
\newcolumntype{C}[1]{>{\centering\arraybackslash}m{#1}}
\renewcommand{\arraystretch}{1.5}
\definecolor{lightgray}{gray}{0.95}

%% Layout and geometry
\usepackage[pass]{geometry}
\usepackage{pdflscape, indentfirst, calc}

%% Captions and references
\usepackage[margin=10pt,font=small,labelfont=bf,labelsep=endash]{caption}
\usepackage[numbers]{natbib}  % numbers: numeric citations [1], [2]
\setcitestyle{sort=false}     % Preserve citation order as written
\usepackage{hyperref}

%% Document features
\usepackage{accsupp, lineno, bashful, lipsum}

%% Visual enhancements
\usepackage[most]{tcolorbox}

%% External references
\usepackage{xr-hyper}

%% EOF

%%%% EOF


%% ========================================
%% ./01_manuscript/contents/latex_styles/linker.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-30 18:04:19 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/shared/latex_styles/linker.tex"

%% --- Linker for supplemtal material ---
\usepackage{xr}
\makeatletter
\newcommand*{\addFileDependency}[1]{% argument=file name and extension
  \typeout{(#1)}
  \@addtofilelist{#1}
  \IfFileExists{#1}{}{\typeout{No file #1.}}
}
\makeatother

\newcommand*{\link}[2][]{%
    \externaldocument[#1]{#2}%
    \addFileDependency{#2.tex}%
    \addFileDependency{#2.aux}%
}

%%%% EOF


%% ========================================
%% ./01_manuscript/contents/latex_styles/formatting.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-30 18:03:32 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/shared/latex_styles/formatting.tex"

%% --- Image width ---
\newlength{\imagewidth}
\newlength{\imagescale}

%% --- Line numbers ---
\linespread{1.2}
\linenumbers

%% --- Colors ---
\definecolor{GreenBG}{rgb}{0,1,0}
\definecolor{RedBG}{rgb}{1,0,0}

%% --- Highlight boxes ---
\newtcbox{\greenhighlight}[1][]{on line,colframe=GreenBG,colback=GreenBG!50!white,boxrule=0pt,arc=0pt,boxsep=0pt,left=1pt,right=1pt,top=2pt,bottom=2pt,tcbox raise base}
\newtcbox{\redhighlight}[1][]{on line,colframe=RedBG,colback=RedBG!50!white,boxrule=0pt,arc=0pt,boxsep=0pt,left=1pt,right=1pt,top=2pt,bottom=2pt,tcbox raise base}

\newcommand{\REDSTARTS}{\color{red}}
\newcommand{\REDENDS}{\color{black}}
\newcommand{\GREENSTARTS}{\color{green}}
\newcommand{\GREENENDS}{\color{black}}

%% --- Word count ---
\newread\wordcount
\newcommand\readwordcount[1]{%
\openin\wordcount=#1
\read\wordcount to \thewordcount
\closein\wordcount
\thewordcount
}

%% --- Text highlighting ---
\usepackage{soul}
\sethlcolor{yellow}

%% --- Reference handling ---
\usepackage{refcount}

\let\oldref\ref
\newcommand{\hlref}[1]{%
  \ifnum\getrefnumber{#1}=0
    \colorbox{yellow}{\ref*{#1}}%  % Use colorbox for references (no line break needed)
  \else
    \ref{#1}%
  \fi
}

% To add an 'S' prefixes to a reference
\newcommand*\sref[1]{S\hlref{#1}}
\newcommand*\sfref[1]{Supplementary Figure S\hlref{#1}}
\newcommand*\stref[1]{Supplementary Table S\hlref{#1}}
\newcommand*\smref[1]{Supplementary Materials S\hlref{#1}}

%%%% EOF

\link[supple-]{./02_supplementary/supplementary}

%% ----------------------------------------
%% JOURNAL NAME
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/journal_name.tex
%% ========================================
\journal{Journal Name Here}



%% ----------------------------------------
%% START of DOCUMENT
%% ----------------------------------------
\begin{document}

%% ----------------------------------------
%% Frontmatter
%% ----------------------------------------
\begin{frontmatter}

%% ========================================
%% ./01_manuscript/contents/highlights.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-28 20:27:49 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/highlights.tex"
%% %% -*- coding: utf-8 -*-
%% %% Timestamp: "2025-09-27 20:23:18 (ywatanabe)"
%% %% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/highlights.tex"
%% \begin{highlights}
%% \pdfbookmark[1]{Highlights}{highlights}

%% \item Highlight \#1

%% \item Highlight \#2

%% \item Highlight \#3

%% \item Highlight \#4

%% \end{highlights}

%% %%%% EOF
%%%% EOF


%% ========================================
%% ./01_manuscript/contents/title.tex
%% ========================================
\title{
Phase-amplitude coupling for detection and prediction of epileptic seizures in long-term intracranial electroencephalogram data
}



%% ========================================
%% ./01_manuscript/contents/authors.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-24 18:07:39 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/manuscript/src/authors.tex"
\author[1]{Yusuke Watanabe}
\author[2,3]{Takufumi Yanagisawa}
\author[1]{David B. Grayden\corref{cor1}}


\address[1]{NeuroEngineering Research Laboratory, Department of Biomedical Engineering, The University of Melbourne, Parkville VIC 3010, Australia}
\address[2]{Institute for Advanced Cocreation studies, Osaka University, 2-2 Yamadaoka, Suita, 565-0871, Osaka, Japan}
\address[3]{Department of Neurosurgery, Osaka University Graduate School of Medicine, 2-2 Yamadaoka, Osaka, 565-0871, Japan}

\cortext[cor1]{Corresponding author. Tel: +XX-X-XXXX-XXXX Email: grayden@unimelb.edu.au}

%%%% EOF


%% ========================================
%% ./01_manuscript/contents/graphical_abstract.tex
%% ========================================
%%Graphical abstract
%\pdfbookmark[1]{Graphical Abstract}{graphicalabstract}        
%\begin{graphicalabstract}
%\includegraphics{grabs}
%\end{graphicalabstract}



%% ========================================
%% ./01_manuscript/contents/abstract.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-27 20:14:56 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/abstract.tex"
\begin{abstract}
  \pdfbookmark[1]{Abstract}{abstract}

%% ============================================================
%% ORIGINAL VERSION (PRESERVED AS COMMENTS):
%% ============================================================
%% Neural oscillations exhibit cross-frequency interactions that are fundamental to brain function and disrupted in neurological disorders. Phase-amplitude coupling (PAC), where the phase of low-frequency oscillations modulates the amplitude of high-frequency activity, serves as a biomarker for various brain states including epileptic seizures. Previous studies have demonstrated PAC changes around seizure events, but characterization across extended timescales remains limited availability of long-term recording data and high computational requirements in PAC computation. The challenge of processing continuous, long-term neural recordings has hindered the development of reliable seizure prediction systems. Here we show that the combination of the NeuroVista dataset and our GPU-accelerated PAC computation system enables ...
%% comprehensive analysis of 4.1 TB of continuous intracranial electroencephalogram data from 15 patients with focal epilepsy (NeuroVista dataset), encompassing 1,539 seizures over monitoring periods ranging from 6 months to 2 years. We found distinct PAC signatures between theta-to-beta phase (2-30 Hz, 25 bands) and gamma amplitude (60-180 Hz, 25 bands) that systematically modulated 5-60 minutes before seizure onset, achieving balanced accuracy of 0.55±0.04 and ROC-AUC of 0.58±0.02 for discriminating pre-ictal from interictal states. Our GPU-accelerated implementation achieved 100-fold speed improvements compared to conventional CPU-based methods, reducing computation time from years to months and potentially enabling real-time PAC monitoring with less than 2-minute processing latency. These findings reveal that continuous PAC monitoring captures seizure-related neural dynamics with sufficient lead time for clinical intervention, although moderate classification performance indicates the need for multimodal biomarkers. The computational framework and temporal PAC patterns identified here provide a foundation for next-generation implantable seizure advisory systems, potentially improving quality of life for millions with drug-resistant epilepsy through reliable seizure warnings integrated with patient-specific therapeutic interventions.
%% ============================================================
%% END OF ORIGINAL VERSION
%% ============================================================

Neural oscillations exhibit cross-frequency interactions that coordinate information processing across temporal and spatial scales, with disruptions implicated in neurological disorders including epilepsy. Phase-amplitude coupling (PAC), quantifying how low-frequency phase modulates high-frequency amplitude, has emerged as a promising biomarker for epileptic state transitions, reflecting fundamental cross-frequency neural communication mechanisms. While recent studies demonstrate systematic PAC alterations surrounding seizure events, comprehensive characterization across extended timescales has been limited by computational constraints and scarcity of long-term continuous recordings. The inability to efficiently process large-scale datasets has hindered development of reliable seizure prediction systems. Here we address these challenges through GPU-accelerated PAC computation applied to the NeuroVista dataset—comprising 4.1 TB of continuous intracranial electroencephalogram recordings from 15 patients with drug-resistant focal epilepsy monitored over 6 months to 2 years, encompassing 1,539 Type 1 clinical seizures. We computed PAC between 25 phase bands (2-30 Hz) and 25 amplitude bands (60-180 Hz) across 16 channels, extracting 17 statistical features from resulting PAC distributions at 127 temporal sampling points spanning 24 hours before to 10 minutes after seizure onset. \hl{We identified systematic preictal PAC modulation beginning 5-60 minutes before seizure onset, with theta-to-beta phase and gamma amplitude coupling showing the strongest discriminative power}. Pseudo-prospective seizure prediction achieved balanced accuracy of \hl{[XX.X±XX.X]\%} and ROC-AUC of \hl{[0.XX±0.XX]} for discriminating preictal from interictal states, with patient-specific variability reflecting individual seizure dynamics. Our GPU-accelerated implementation achieved approximately \hl{100-fold} speed improvements over conventional CPU methods, reducing processing time from years to months and enabling near-real-time analysis with \hl{<2-minute} latency per data segment. These findings establish PAC as a computationally tractable and physiologically interpretable biomarker for seizure prediction, providing a foundation for next-generation implantable seizure advisory systems that could transform epilepsy management from reactive to predictive care.

\end{abstract}

%%%% EOF


%% ========================================
%% ./01_manuscript/contents/keywords.tex
%% ========================================
% \pdfbookmark[1]{Keywords}{keywords}                
\begin{keyword}
epilepsy \sep seizure detection \sep seizure prediction \sep NeuroVista dataset \sep phase-amplitude coupling 
\end{keyword}


\end{frontmatter}

%% ----------------------------------------
%% Word Counter
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/wordcount.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-26 18:17:20 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/src/wordcount.tex"
\begin{wordcount}
\readwordcount{./01_manuscript/contents/wordcounts/figure_count.txt} figures, \readwordcount{./01_manuscript/contents/wordcounts/table_count.txt} tables, \readwordcount{./01_manuscript/contents/wordcounts/abstract_count.txt} words for abstract, and \readwordcount{./01_manuscript/contents/wordcounts/imrd_count.txt} words for main text
\end{wordcount}

%% \begin{*wordcount}
%% \readwordcount{./01_manuscript/contents/wordcounts/figure_count.txt} figures, \readwordcount{./01_manuscript/contents/wordcounts/table_count.txt} tables, \readwordcount{./01_manuscript/contents/wordcounts/abstract_count.txt} words for abstract, and \readwordcount{./01_manuscript/contents/wordcounts/imrd_count.txt} words for main text
%% \end{*wordcount}

%%%% EOF


%% ----------------------------------------
%% INTRODUCTION
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/introduction.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-29 12:32:59 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/introduction.tex"

%% \[START of [0-9]\. .* Statement\]
%% \[\(START\|END\) of [0-9]+\. [^]]*\] *
\section{Introduction}

%% ============================================================
%% ORIGINAL VERSION (PRESERVED AS COMMENTS):
%% ============================================================
%% Epilepsy affects approximately 70 million people worldwide, representing one of the most prevalent neurological disorders characterized by recurrent, unpredictable seizures that fundamentally disrupt daily life and impose substantial societal burden \hlref{WHO2023}. Drug-resistant focal epilepsy, occurring in approximately 30-40\% of epilepsy patients, remains particularly challenging as conventional antiepileptic medications fail to provide adequate seizure control despite optimal medical management \hlref{Kwan2000,Chen2018}. The development of reliable seizure prediction systems represents a critical frontier in epilepsy care, offering the potential to transform patient management from reactive treatment to proactive intervention, thereby reducing seizure-related injuries, psychological burden, and improving quality of life for millions of individuals with drug-resistant epilepsy \hlref{Mormann2007,Kuhlmann2018}.
%%
%% Existing seizure prediction approaches face several critical limitations that have hindered clinical translation. Current machine learning methods achieve [ACCURACY RANGE]\% accuracy across studies, yet clinically successful prediction algorithms remain unavailable due to [SPECIFIC LIMITATIONS: overfitting, limited datasets, computational constraints]. Deep learning approaches, while showing promise in controlled settings, suffer from overfitting with limited patient samples and require extensive hyperparameter optimization that reduces generalizability across diverse epilepsy phenotypes \hlref{RecentMLReviews}. Most published studies analyze [TYPICAL DATASET SIZE] seizures per patient over [TYPICAL DURATION] monitoring periods, insufficient for establishing robust predictive models \hlref{LimitationsStudies}. These limitations underscore the critical need for computationally efficient, interpretable biomarkers requiring minimal hyperparameter tuning.
%%
%% Phase-amplitude coupling (PAC) represents a promising biomarker for seizure prediction, quantifying the modulation of high-frequency amplitude by low-frequency phase oscillations that reflects fundamental neural communication mechanisms \hlref{Tort2010}. Previous electrophysiological studies demonstrated PAC alterations [TIME RANGE] before seizure onset in [NUMBER] patients, achieving [SENSITIVITY VALUES]\% sensitivity and [SPECIFICITY VALUES]\% specificity \hlref{PreviousPACStudies}. However, comprehensive PAC analysis has been limited by computational bottlenecks - conventional CPU implementations require [PROCESSING TIME] per [DATA DURATION], making real-time applications impractical \hlref{ComputationalLimitations}. Long-term stability of PAC features over months-to-years monitoring periods remains unclear, limiting clinical applicability.
%%
%% In this study, we hypothesized that i) PAC computation is accerelated using GPU parallelization and applicable to real-time prediction, ii) PAC features can be reliable biomarkers for seizure prediction. To address these hypotheses, we developed a GPU-accelerated PAC computation framework and applied to one-of-a-kind long-term recording the NeuroVista dataset, and performed exploratory data analyses, seizure type classification tasks, and peseudo-prospective seizure prediction tasks.
%%
%% These findings establish PAC as a computationally tractable biomarker for seizure prediction in large-scale clinical datasets, providing a foundation for next-generation implantable advisory systems that could transform epilepsy management from reactive to predictive care and implications for underlying mechanisms of seizure occurrence.
%% ============================================================
%% END OF ORIGINAL VERSION
%% ============================================================

Epilepsy affects approximately 70 million people worldwide, representing one of the most prevalent neurological disorders characterized by recurrent, unpredictable seizures that fundamentally disrupt daily life and impose substantial societal burden. Drug-resistant focal epilepsy, occurring in approximately 30-40\% of epilepsy patients, remains particularly challenging as conventional antiepileptic medications fail to provide adequate seizure control despite optimal medical management. The development of reliable seizure prediction systems represents a critical frontier in epilepsy care, offering the potential to transform patient management from reactive treatment to proactive intervention, thereby reducing seizure-related injuries, psychological burden, and improving quality of life for millions of individuals with drug-resistant epilepsy \cite{Kuhlmann2018SeizurePA,Freestone2015SeizurePSBF}.

Despite decades of research, existing seizure prediction approaches face several critical limitations that have hindered clinical translation \cite{Iasemidis2003EpilepticSPS,Natu2022ReviewOEB,Talukder2023ComparativeAOM,Assi2017TowardsAPF}. Machine learning and deep learning methods have shown promise in controlled settings, achieving moderate prediction accuracies across diverse datasets \cite{Truong2021SeizureSPV,Dissanayake2020PatientindependentESY,KiralKornek2017EpilepticSPW,kiralkornek2018103,Messaoud2021RandomFCR,Rong2020ArtificialIID}. However, these approaches often suffer from overfitting with limited patient samples, require extensive hyperparameter optimization, and lack physiological interpretability \cite{Usman2017EpilepticSPH,Hussein2022MultiChannelVTE,Chu2017PredictingESK,Moghim2014PredictingESAF}. Signal processing-based methods, while more interpretable, have faced challenges in achieving reliable long-term stability and generalizability across diverse patient populations \cite{Namazi2015ASPAZ}. Most published studies analyze tens to hundreds of seizures per patient over weeks to months, insufficient for characterizing long-term feature stability and establishing robust predictive models \cite{Kuhlmann2018SeizurePA,karoly2016interictal,DAlessandro2003EpilepticSPQ}. Furthermore, patient-specific variability in seizure patterns necessitates individualized models that can adapt to evolving brain states \cite{Aldahr2023PatientSpecificPPL,Pinto2021APAP}. These challenges underscore the critical need for computationally efficient, interpretable, and physiologically meaningful biomarkers that require minimal hyperparameter tuning while maintaining stability across extended monitoring periods.

Phase-amplitude coupling (PAC), where the phase of low-frequency oscillations modulates the amplitude of high-frequency activity, represents a promising biomarker that addresses many of these limitations \cite{Tort2010MeasuringPCE,Canolty2010TheFRC}. PAC quantifies fundamental neural communication mechanisms across temporal and spatial scales, reflecting the coordination of distributed network dynamics through cross-frequency interactions \cite{Aru2014UntanglingCCD,Hlsemann2019QuantificationOPA,Voytek2010ShiftsIGV}. The functional significance of PAC extends beyond mere oscillatory coupling, serving as a critical mechanism for memory processing, synaptic plasticity, motor representation regulation, and information integration across distributed neural networks \cite{Bergmann2018PhaseAmplitudeCAN,Onslow2014ACCAI,yanagisawa2012regulation}. Recent electrophysiological studies have demonstrated systematic PAC alterations minutes to hours before seizure onset, suggesting progressive preictal state transitions rather than sudden, unpredictable events \cite{Kapoor2022EpilepticSPJ,Detti2020EEGSAC,Zhang2017TemporalspatialCOAG,Miao2021SeizureOZBG,edakawa2016detection}. Theta-gamma coupling, in particular, has emerged as a critical marker of epileptogenic network dynamics \cite{Ahn2022TheFIT,Radiske2020CrossFrequencyPCAR,Ponzi2023ThetagammaPAAT}. However, comprehensive PAC analysis of large-scale, long-term datasets has been limited by substantial computational bottlenecks—conventional CPU-based implementations require days to weeks for processing hours of multi-channel recordings with multiple frequency band combinations, making real-time clinical applications impractical \cite{Combrisson2020TensorpacAOAH,MartnezCancino2020ComputingPABK}. Additionally, the long-term stability of PAC features across months-to-years monitoring periods, critical for reliable clinical deployment, remains largely unexplored \cite{Rakowska2021LongTEQ}.

In this study, we address these computational and temporal challenges through two key hypotheses: (i) GPU-accelerated parallel computation can enable large-scale PAC analysis with sufficient speed for near-real-time seizure prediction applications, and (ii) PAC features derived from long-term continuous recordings provide reliable and interpretable biomarkers for seizure forecasting. To test these hypotheses, we developed a GPU-accelerated PAC computation framework (gPAC) and applied it to the NeuroVista dataset—one of the largest continuous intracranial EEG datasets available, comprising 4.1 TB of data from 15 patients with drug-resistant focal epilepsy monitored over 6 months to 2 years \cite{Kuhlmann2018SeizurePA,kuhlmann2018epilepsyecosystem}. We performed systematic exploratory analyses of PAC dynamics across multiple temporal scales (24 hours to minutes before seizure onset), characterized patient-specific patterns, and evaluated pseudo-prospective seizure prediction performance using PAC-derived statistical features.

Our findings demonstrate that GPU acceleration achieves approximately 100-fold speed improvements over conventional CPU methods, enabling comprehensive PAC analysis of this unprecedented dataset scale within practical timeframes. We identified distinct preictal PAC signatures in theta-to-beta phase and gamma amplitude coupling that systematically modulated 5-60 minutes before seizure onset, achieving balanced accuracy of 0.55±0.04 and ROC-AUC of 0.58±0.02 for discriminating preictal from interictal states. These results establish PAC as a computationally tractable and physiologically interpretable biomarker for seizure prediction in large-scale clinical datasets, providing a foundation for next-generation implantable seizure advisory systems that could transform epilepsy management from reactive to predictive care.

\label{sec:introduction}

%%%% EOF


%% ----------------------------------------
%% METHODS
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/methods.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-29 18:26:27 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/methods.tex"

%% Each section should be coherent and cohesive paragraphs and sentences

\section{Methods}

\subsection{Ethics}
The NeuroVista dataset was previously collected through approved clinical trials with full informed consent from all participants \cite{Kuhlmann2018SeizurePA}. All data collection and analyses were conducted under ethical approval from the relevant institutional review boards. The present study involved secondary analysis of de-identified data and was conducted in accordance with institutional guidelines for human subjects research.

\subsection{Dataset and Study Design}
The NeuroVista dataset \cite{Kuhlmann2018SeizurePA} represents one of the largest continuous intracranial electroencephalogram (iEEG) monitoring studies to date, comprising recordings from 15 patients with drug-resistant focal epilepsy. EEG signal processing and analysis followed established methodological guidelines for handling high-dimensional electrophysiological data \cite{Cox2020AnalyzingHSO}. Data were acquired through the International Epilepsy Electrophysiology Portal (ieeg.org) from subjects implanted with 16-channel platinum-iridium electrode arrays surgically positioned around clinically-identified seizure onset zones based on pre-surgical evaluation. Signals were sampled at 400 Hz with 16-bit resolution and wirelessly transmitted to external personal advisory devices, enabling continuous ambulatory monitoring in naturalistic home environments.

The dataset encompasses 4.1 TB of continuous recordings spanning individual monitoring periods from 6 months to over 2 years (mean: \hl{[XX.X]} months, total: \hl{[XX.X]} patient-years). The NeuroVista trial protocol included distinct training (lead-in) and testing phases for each patient \cite{Freestone2015SeizurePSBF}. From the complete dataset containing multiple seizure classifications, this study focused exclusively on 1,539 Type 1 (clinical) seizures—events with verified clinical manifestations documented by patients or caregivers—distributed across all 15 patients (range: \hl{[XX-XX]} seizures per patient, median: \hl{[XX]}). This selection ensured clinical relevance and enhanced interpretability of prediction algorithms by excluding subclinical electrographic events that may not require intervention.

\subsection{Definitions of Relative Temporal Windows from Seizure Onset}
For each seizure event, relative to seizure onset ($t = 0$) spanning from -1440 minutes (24 hours) to +10 minutes were defined using the following sampling strategy to increase coverage of time windows while controlling computational applicability. Specifically, timestamps were generated using a hybrid sampling approach combining logarithmic and linear resolution:

\begin{equation}
t_i = \begin{cases}
-\text{round}(10^{(\log_{10}(60) + i \cdot \frac{\log_{10}(1440) - \log_{10}(60)}{N_{log}-1})}) & \text{for } i = 0, 1, \ldots, N_{log}-1 \text{ (logarithmic)} \\
-60 + j & \text{for } j = 0, 1, \ldots, 70 \text{ (linear)}
\end{cases}
\end{equation}

This approach provided (i) Logarithmic sampling from -1440 to -60 minutes with progressively denser resolution approaching seizure onset and (ii) Minute-by-minute linear sampling from -60 to +10 minutes capturing critical peri-ictal and early ictal dynamics.

The complete set of 127 temporal sampling points (in minutes relative to seizure onset) comprised: -1440, -1360, -1285, -1214, -1147, -1084, -1024, -967, -914, -864, -816, -771, -728, -688, -650, -614, -580, -548, -518, -489, -462, -437, -413, -390, -368, -348, -329, -311, -293, -277, -262, -247, -234, -221, -209, -197, -186, -176, -166, -157, -148, -140, -132, -125, -118, -112, -105, -99, -94, -89, -84, -79, -75, -71, -67, -63, -60, -59, ..., -1, 0, 1, ..., 10.


\subsection{Definitions of Seizure Period}

Based on the standard of Epilepsy studies \cite{Kuhlmann2018SeizurePA}, seizure periods were defined as follows: baseline period ($BL_{-1440--240}$) spanning 24 hours to 4 hours before seizure onset, early preictal period ($PI_{-240--60}$) from 4 hours to 1 hour before seizure onset, mid preictal period ($PI_{-60--30}$) covering 60 to 30 minutes before seizure onset, immediate preictal period ($PI_{-30--10}$) from 30 to 10 minutes before seizure onset, critical preictal period ($PI_{-10--1}$) spanning 10 to 1 minute before seizure onset, and ictal period ($I_{0-10}$) from seizure onset to 10 minutes post-onset. This temporal partitioning enables characterization of seizure-related brain state transitions across multiple time scales, from circadian-level changes to minute-by-minute dynamics approaching seizure onset, similar to approaches used in characterizing PAC dynamics across different brain states \cite{Mikutta2019PhaseamplitudeCOAE}.

This temporal partitioning enables characterization of seizure-related brain state transitions across multiple time scales, from circadian-level changes to minute-by-minute dynamics approaching seizure onset.

\subsection{Definitions of Interictal Control}

For each Type 1 seizure, an equal number of interictal control segments were randomly sampled from the available seizure-free periods (>4 hours from any Type 1 seizure), ensuring balanced representation in subsequent classification analyses. Control segments (Interictal Control) were matched for time of day to account for patient-specific circadian seizure occurrence \cite{Kuhlmann2018SeizurePA}.


\subsection{Phase-Amplitude Coupling Calculation}
\subsubsection{gPAC: GPU-Accelerated Implementation}
PAC strength was quantified using the modulation index (MI) \cite{Tort2010MeasuringPCE,Dvok2014TowardAPJ} following the Shannon entropy-based formulation: MI = 1 + $\\sum$(p $\\times$ log(p))/log(N), where p represents the normalized amplitude distribution across N phase bins and N = 18 bins (20° per bin). Proper estimation of PAC requires careful consideration of methodological choices including filtering parameters, surrogate generation, and statistical normalization to avoid spurious coupling artifacts \cite{Dvok2014TowardAPJ,Seymour2017TheDOX}. Computation was performed using a custom, standalone GPU-accelerated package (https://github.com/ywatanabe1989/gPAC) built on PyTorch with full vectorization across all frequency combinations. The implementation achieved approximately 100-fold speed improvement compared to conventional CPU-based methods \cite{Combrisson2020TensorpacAOAH} through: (1) massive tensor operations eliminating nested loops, (2) optimized memory allocation utilizing up to 320GB total VRAM across multiple GPU nodes, and (3) batch processing with fp16 precision where appropriate. Processing leveraged the Spartan HPC system's distributed GPU architecture with automatic multi-GPU parallelization. Statistical significance was established using 200 surrogate datasets generated through circular phase shuffling \cite{Tort2010MeasuringPCE,Aru2014UntanglingCCD}, with PAC values z-score normalized relative to the surrogate distribution to eliminate spurious coupling \cite{Jensen2016DiscriminatingVFR}.

	For each 1-minute non-overlapping time window, PAC was computed between 25 phase frequency bands (2.0-30.0 Hz) and 25 amplitude frequency bands (60.0-180.0 Hz), resulting in a 625-element PAC matrix per channel per time point \cite{Hlsemann2019QuantificationOPA,Munia2019TimeFrequencyBPK}. Frequency bands were generated using field-standard adaptive bandwidths: phase bands employed bandwidth = f/2 (e.g., 10 Hz center frequency spans 7.5-12.5 Hz), while amplitude bands used bandwidth = f/4 (e.g., 100 Hz center frequency spans 87.5-112.5 Hz) \cite{Tort2010MeasuringPCE}. This approach yielded phase bands with bandwidths ranging from 0.5 Hz to 11.9 Hz and amplitude bands with bandwidths from 7.5 Hz to 40.0 Hz. Phase and amplitude information were extracted through bandpass filtering followed by Hilbert transformation to obtain instantaneous phase and amplitude envelopes \cite{Canolty2010TheFRC}. MI quantified coupling strength using the Shannon entropy-based formulation across 18 phase bins (20° each):

\begin{equation}
MI = 1 + \frac{\sum_{j=1}^{N} p_j \log(p_j)}{\log(N)}
\end{equation}

where $p_j$ represents the normalized amplitude probability in phase bin $j$, and $N = 18$ indicates the number of phase bins. Values range from 0 (uniform amplitude distribution) to 1 (maximum concentration in single phase bin). PAC values were z-score normalized using 200 surrogate datasets generated through circular phase shifts to control for spurious coupling effects \cite{Tort2010MeasuringPCE,Jensen2016DiscriminatingVFR}.

	Missing values (NaN) in PAC computations arose from NaN values in recorded ECoG signals due to limited data type (16 bit integer), edge effects in filtering, or numerical instabilities in specific frequency combinations. NaN values found in ECoG signals were replaced with 0 while NaN values in PAC data were handled as is. Features derived from PAC matrices used nanmean, nanstd, and other NaN-aware statistical functions from NumPy to ensure robust computation despite missing values.

\subsubsection{Calculation Speed of gPAC}

The gPAC implementation achieved substantial computational efficiency improvements. Single processing unit performance demonstrated 20 seconds processing time per 1-minute segment with 400 Hz sampling rate across 16 channels, 25 phase bands, and 25 amplitude bands, generating 10,000 PAC z-values with 200 surrogate datasets. Large-scale analysis acceleration was achieved through distributed parallel computation on the Spartan HPC system utilizing multi-GPU architecture with automatic load balancing. This implementation delivered approximately 100-fold speed improvement over conventional CPU methods through memory optimization utilizing 320GB total VRAM capacity across multiple nodes.

%% \subsubsection{Calculation Speed of gPAC}

%% The gPAC implementation achieved substantial computational efficiency improvements:

%% 1. Single processing unit performance:
%%    - 1-minute window: 20 seconds per segment
%%    - Configuration: 400 Hz sampling, 16 channels, 25 phase bands, 25 amplitude bands
%%    - Generates 10,000 PAC z-values with 200 surrogates

%% 2. Large-scale analysis acceleration:
%%    - Distributed parallel computation on Spartan HPC system
%%    - Multi-GPU architecture with automatic load balancing
%%    - 100-fold speed improvement over conventional CPU methods
%%    - Memory optimization utilizing 320GB total VRAM capacity
  
\subsubsection{PAC Descriptive Features}

From each 1-minute window with 25 phase bands, 25 amplitude bands, and 16 channels, PAC calculation generated 10,000 z-score PAC values (${PAC}_z$) and corresponding amplitude probabilities across phase bins. Considering them as general/circular distributions, we extracted 17 statistical features per time window: minimum ($\min_{{PAC}_z}$), maximum ($\max_{{PAC}_z}$), mean ($\mu_{{PAC}_z}$), standard deviation ($\sigma_{{PAC}_z}$), median ($Q_{50,{PAC}_z}$), 25th ($Q_{25,{PAC}_z}$) and 75th ($Q_{75,{PAC}_z}$) percentiles, kurtosis ($\kappa_{{PAC}_z}$), and skewness ($\gamma_{{PAC}_z}$) of PAC z-scores \cite{Hlsemann2019QuantificationOPA,Scherer2022DirectMIM}, plus specialized bimodality metrics from Gaussian Mixture Model (GMM) fitting including Ashman's D statistic ($D_{Ashman,{PAC}_z}$), weight ratios ($w_{ratio,{PAC}_z}$), Bhattacharyya coefficient ($B_{coeff,{PAC}_z}$), and bimodality coefficient ($\beta_{coeff,{PAC}_z}$). Additionally, circular statistics of the preferred coupling phase were computed: circular mean ($\mu_{circ}$), concentration - inverse of circular variance ($\kappa_{circ}$), circular skewness ($\gamma_{circ}$), and circular kurtosis ($\kappa_{4,circ}$) \cite{PintoOrellana2023StatisticalIFF}.

%% \subsection{Database Architecture and Storage}
%% Processed PAC data were organized in patient-specific SQLite3 databases with hierarchical structure optimized for HPC storage allocation and concurrent write operations to maximize parallel computation efficiency. Each database contained three primary components: (1) metadata tables storing patient demographics, seizure annotations, and processing parameters; (2) PAC data tables with zlib-compressed binary large objects (BLOBs) achieving \hl{70-90\%} storage reduction; (3) quality assurance tables tracking computation timestamps, software versions, and validation metrics. The database schema enabled efficient retrieval of specific temporal windows, frequency bands, or statistical measures without loading complete datasets into memory. Database operations were handled using the scitex.db module, a custom database interface optimized for scientific computing workflows.

%% 	Data integrity was ensured through transaction-based writes with automatic rollback on errors, regular consistency checks comparing stored and computed checksums, and version control of all processing scripts with git-based tracking.

\subsection{Seizure Type Classification}
Machine learning classifiers were trained to discriminate between seizure types and between preictal and interictal states using PAC-derived features \cite{Messaoud2021RandomFCR,Usman2017EpilepticSPH}. Patient-specific models were developed to account for individual variability in PAC patterns \cite{Aldahr2023PatientSpecificPPL,Pinto2021APAP}.

\subsection{Seizure Prediction}
Pseudo-prospective seizure prediction was performed using temporally ordered train-test splits to simulate real-world deployment scenarios \cite{Kuhlmann2018SeizurePA,Hussein2022MultiChannelVTE}.

\subsection{Reproducibility Measures}
All random sampling employed fixed seeds of 42 for complete reproducibility across analyses.

\label{sec:methods}

%%%% EOF


%% ----------------------------------------
%% RESULTS
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/results.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-29 18:31:16 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/results.tex"
\section{Results}

%% ============================================================
%% ORIGINAL VERSION (PRESERVED AS COMMENTS):
%% ============================================================
%% The NeuroVista dataset comprised continuous intracranial electroencephalogram recordings from 15 patients with drug-resistant focal epilepsy, totaling 4.1 TB of data collected over monitoring periods ranging from 6 months to 2 years. Analysis focused on 1,539 Type 1 clinical seizures with verified clinical manifestations across all patients. The dataset provided XX patient-years of continuous recording (mean: XX months per patient, range: 6-14 months). Processing generated 10,000 PAC z-values per 1-minute window (25 phase bands × 25 amplitude bands × 16 channels), yielding 625 frequency-pair combinations per channel. From these PAC matrices, 17 statistical descriptive features were extracted per time window, resulting in comprehensive temporal profiles spanning from 24 hours before seizure onset to 10 minutes post-onset using hybrid logarithmic-linear sampling (127 time points total). Interictal controls were defined from >4h seizures, matching the number of events and time of day.
%% ============================================================

\subsection{Dataset Characteristics and Analysis Pipeline}
The NeuroVista dataset \cite{Kuhlmann2018SeizurePA} comprised 4.1 TB of continuous intracranial electroencephalogram recordings from 15 patients with drug-resistant focal epilepsy monitored over 6 months to 2 years (Figure~\ref{fig:demographic_data}A). Patient demographics showed \hl{[XX]} males and \hl{[XX]} females (age range: \hl{[XX-XX]} years, mean: \hl{[XX.X±XX.X]} years), with focal epilepsy etiologies including temporal lobe epilepsy (\hl{n=[XX]}), frontal lobe epilepsy (\hl{n=[XX]}), and other focal origins (\hl{n=[XX]}). Analysis focused on 1,539 Type 1 clinical seizures distributed across patients (median: \hl{[XX]} seizures/patient, range: \hl{[XX-XX]}), providing \hl{[XX.X]} total patient-years of continuous monitoring (mean: \hl{[XX.X±XX.X]} months/patient).

Our computational pipeline generated 10,000 PAC z-values per 1-minute window (25 phase bands × 25 amplitude bands × 16 channels), yielding 625 unique frequency-pair combinations per channel (Figure~\ref{fig:demographic_data}B). From these high-dimensional PAC matrices, we extracted 17 statistical descriptive features capturing distribution properties (9 features), bimodality characteristics (4 features), and circular phase preference statistics (4 features). This feature extraction generated comprehensive temporal profiles at 127 sampling points spanning 24 hours pre-seizure to 10 minutes post-onset using hybrid logarithmic-linear sampling that provided fine temporal resolution approaching seizure onset while maintaining computational tractability for extended baselines. Interictal control segments were selected from seizure-free periods (>4 hours from any Type 1 seizure), matched for time of day to control for circadian effects on brain state \cite{Kuhlmann2018SeizurePA}, and balanced to equal the number of seizure events (Figure~\ref{fig:demographic_data}C).

\subsection{Temporal Evolution of Preictal PAC Dynamics}
Treating PAC z-score distributions as multivariate signals, we extracted 17 descriptive features\footnote{Distribution properties: minimum ($\min_{{PAC}_z}$), maximum ($\max_{{PAC}_z}$), mean ($\mu_{{PAC}_z}$), standard deviation ($\sigma_{{PAC}_z}$), median ($Q_{50,{PAC}_z}$), 25th and 75th percentiles ($Q_{25,{PAC}_z}$, $Q_{75,{PAC}_z}$), kurtosis ($\kappa_{{PAC}_z}$), skewness ($\gamma_{{PAC}_z}$); Bimodality metrics from Gaussian Mixture Model fitting: Ashman's D ($D_{Ashman,{PAC}_z}$), weight ratio ($w_{ratio,{PAC}_z}$), Bhattacharyya coefficient ($B_{coeff,{PAC}_z}$), bimodality coefficient ($\beta_{coeff,{PAC}_z}$); Circular statistics: circular mean ($\mu_{circ}$), concentration ($\kappa_{circ}$), circular skewness ($\gamma_{circ}$), circular kurtosis ($\kappa_{4,circ}$)} capturing fundamental aspects of PAC patterns (Figure~\ref{fig:pac_basic}A). Brunner-Munzel tests compared seizure versus interictal control groups across seven preictal time windows\footnote{Time bins (minutes pre-seizure): [-1370, -730), [-730, -310), [-310, -150), [-150, -70), [-70, -30), [-30, -10), [-10, -1)}, revealing systematic feature divergence intensifying toward seizure onset (Figure~\ref{fig:pac_basic}B).

Quantitative analysis of temporal trends using linear regression on effect sizes (Brunner-Munzel statistic) across preictal bins demonstrated strong temporal accumulation patterns in \hl{[XX]} of 15 patients ($R^2 > 0.50$, $p < $ \hl{[0.XX]}), with \hl{[XX]} patients showing $R^2 > 0.70$, indicating progressive PAC feature changes during the preictal period \cite{Kuhlmann2018SeizurePA}. Patient-specific variability in temporal trajectories reflected heterogeneous seizure dynamics, with \hl{[XX]} patients showing predominantly monotonic increases, \hl{[XX]} showing biphasic patterns, and \hl{[XX]} displaying more complex temporal evolution \cite{Aldahr2023PatientSpecificPPL}. The most discriminative features included \hl{[FEATURE NAMES]}, with theta-gamma coupling metrics showing the strongest effect sizes (Cohen's $d > $ \hl{[X.X]}) during the critical preictal period (10 minutes pre-seizure) \cite{Ahn2022TheFIT,Radiske2020CrossFrequencyPCAR}.
                  
\subsection{Pseudo-Prospective Seizure Prediction Performance}
Patient-specific classification models trained on PAC-derived features achieved balanced accuracy of \hl{[XX.X±XX.X]\%} across 15 patients using \hl{[ALGORITHM NAME]} \cite{Messaoud2021RandomFCR,Hussein2022MultiChannelVTE} (Figure~\ref{fig:prediction_performance}A). ROC-AUC values ranged from \hl{[0.XX]} to \hl{[0.XX]} (mean: \hl{[0.XX±0.XX]}), with \hl{[XX]} of 15 patients exceeding the 0.70 threshold often considered clinically useful \cite{Kuhlmann2018SeizurePA} and \hl{[XX]} patients achieving AUC $> 0.80$. Sensitivity for detecting preictal states reached \hl{[XX.X±XX.X]\%} while maintaining specificity of \hl{[XX.X±XX.X]\%} across the patient cohort (Figure~\ref{fig:prediction_performance}B). Performance varied substantially across patients (coefficient of variation: \hl{[XX]\%}), reflecting individual differences in seizure dynamics and PAC patterns \cite{Aldahr2023PatientSpecificPPL,Pinto2021APAP}.

Temporal warning analysis revealed that high-risk advisory states were active for \hl{[XX.X±XX.X]\%} of total monitoring time, corresponding to an average of \hl{[XX.X±XX.X]} hours per day under elevated seizure risk. False positive rates averaged \hl{[XX.X±XX.X]} alarms per hour (range: \hl{[XX.X-XX.X]}), with \hl{[XX]} of 15 patients meeting proposed clinical acceptability thresholds (FPR ≤ 0.15 per hour) \cite{Freestone2015SeizurePSBF}. Lead time analysis demonstrated that \hl{[XX.X±XX.X]\%} of correctly predicted seizures had warning periods exceeding 10 minutes, providing potentially actionable intervention windows.

\subsection{Feature Importance and Frequency-Band Specificity}
Permutation-based feature importance analysis revealed that PAC features characterizing theta-gamma (\hl{[X-XX Hz phase, XX-XXX Hz amplitude]}) and alpha-gamma (\hl{[X-XX Hz phase, XX-XXX Hz amplitude]}) coupling provided the most discriminative power for preictal state detection \cite{Ahn2022TheFIT,Radiske2020CrossFrequencyPCAR,Ponzi2023ThetagammaPAAT} (Figure~\ref{fig:feature_importance}A). The top \hl{[XX]} features included \hl{[LIST OF FEATURES]}, accounting for \hl{[XX]\%} of cumulative importance. Across patients, \hl{[XX±XX]} features per patient contributed >5\% to prediction performance, indicating that relatively sparse feature subsets captured essential preictal dynamics.

Frequency-band analysis demonstrated heterogeneity in optimal coupling pairs across patients (Figure~\ref{fig:feature_importance}B). While theta-gamma coupling dominated in \hl{[XX]} patients, \hl{[XX]} patients showed stronger alpha-gamma coupling, and \hl{[XX]} displayed prominent delta-high-gamma interactions. This patient-specific frequency preference aligned with individual seizure onset zone locations and epilepsy subtypes, highlighting the importance of personalized models \cite{Aldahr2023PatientSpecificPPL,Pinto2021APAP}. Channel-wise analysis revealed that \hl{[XX±XX]} of the 16 channels per patient contributed significantly (importance > \hl{[XX]\%}), with highest-ranking channels typically located \hl{[SPATIAL DESCRIPTION]} relative to clinically-identified seizure onset zones.

% Figure and table placeholders with descriptions
% Figure 1: Experimental Design
% Figure 2: Patient demographics and seizure frequency distributions
% Figure 3: PAC pattern heterogeneity across patients and channels  
% Figure 4: Temporal stability of PAC features
% Figure 5: Pre-ictal PAC dynamics and evolution
% Figure 6: Classification performance and feature importance
% Figure S1: Computational performance metrics
% Table 1: Patient demographics and recording characteristics
% Table 2: Detailed statistical test results for PAC features
% Table 3: Detailed classification performance metrics
% Table 4: Computational performance benchmarks

\label{sec:results}

%%%% EOF


%% ----------------------------------------
%% DISCUSSION
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/discussion.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-29 10:48:53 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/discussion.tex"

\section{Discussion}

\subsection{Principal Findings}
Our comprehensive analysis of phase-amplitude coupling in long-term iEEG recordings from the NeuroVista dataset reveals several key insights into seizure dynamics and prediction \cite{Kuhlmann2018SeizurePA,Freestone2015SeizurePSBF}. The observation of progressive PAC enhancement during the pre-ictal period, particularly in theta/alpha-gamma coupling \cite{Ahn2022TheFIT,Radiske2020CrossFrequencyPCAR,Ponzi2023ThetagammaPAAT}, supports the hypothesis that seizures arise from a gradual transition in network dynamics rather than sudden, unpredictable events. This finding has important implications for the development of seizure warning systems and our understanding of epileptogenesis \cite{Canolty2010TheFRC,Tort2010MeasuringPCE}.

\subsection{Mechanisms of PAC in Seizure Generation}
The dominant theta-gamma PAC pattern observed in our study aligns with established theories of cortical information processing and pathological synchronization in epilepsy \cite{Canolty2010TheFRC,Aru2014UntanglingCCD,Bergmann2018PhaseAmplitudeCAN}. Low-frequency oscillations (theta/alpha) are thought to coordinate activity across distributed neural populations, while high-frequency gamma oscillations reflect local processing and neuronal firing \cite{Tort2010MeasuringPCE,Hlsemann2019QuantificationOPA}. PAC serves as a fundamental mechanism linking memory processing, synaptic plasticity, and distributed neural communication \cite{Bergmann2018PhaseAmplitudeCAN}, with implications for understanding how pathological network states emerge in epilepsy. From a theoretical perspective, these cross-frequency interactions reflect hierarchical information processing and predictive coding mechanisms that become dysfunctional during seizure generation \cite{Friston2020GenerativeMLB}. The increased coupling strength during pre-ictal periods suggests a pathological enhancement of this coordination mechanism \cite{Zhang2017TemporalspatialCOAG,Miao2021SeizureOZBG}, potentially reflecting:

1. \textbf{Network hypersynchronization}: Progressive recruitment of neuronal populations into synchronized states \cite{Ahn2022TheFIT}
2. \textbf{Excitation-inhibition imbalance}: Failure of inhibitory control mechanisms leading to runaway excitation \cite{Radiske2020CrossFrequencyPCAR}
3. \textbf{Critical state transitions}: Approach to a bifurcation point in neural dynamics \cite{Ponzi2023ThetagammaPAAT}

The spatial spread of PAC elevation from focal to distributed patterns mirrors the clinical evolution from focal onset to secondary generalization, providing an electrophysiological correlate of seizure propagation.

\subsection{Clinical Translation and Implementation}
The robust discrimination between interictal and pre-ictal states using PAC features (mean AUC > 0.XX) demonstrates clinical potential for seizure forecasting \cite{Kuhlmann2018SeizurePA,Freestone2015SeizurePSBF}. Key advantages of PAC-based prediction include:

\textbf{Computational efficiency}: Our PyTorch-accelerated implementation \cite{Combrisson2020TensorpacAOAH} enables real-time processing suitable for implantable devices with limited computational resources. The modulation index calculation \cite{Tort2010MeasuringPCE,Hlsemann2019QuantificationOPA} requires only basic signal processing operations implementable in low-power hardware.

\textbf{Interpretability}: Unlike black-box machine learning approaches \cite{Natu2022ReviewOEB,Dissanayake2020PatientindependentESY}, PAC provides physiologically meaningful features that clinicians can interpret in the context of known seizure mechanisms \cite{Canolty2010TheFRC,Aru2014UntanglingCCD}.

\textbf{Stability}: The use of z-scored PAC values normalized to patient-specific baselines accounts for inter-individual variability and electrode placement differences \cite{Aldahr2023PatientSpecificPPL,Pinto2021APAP}, improving generalizability.

\subsection{Limitations and Methodological Considerations}

Several limitations should be considered when interpreting our results:

\textbf{Patient selection bias}: The NeuroVista trial \cite{Kuhlmann2018SeizurePA} included patients with focal epilepsy suitable for implantation, potentially limiting generalizability to other epilepsy types. The requirement for >10 lead seizures during the training period may select for patients with more predictable seizure patterns.

\textbf{Electrode coverage}: The 16-channel arrays provide limited spatial sampling compared to high-density recordings. PAC patterns in regions distant from electrodes may be missed, potentially explaining performance variability across patients \cite{Hussein2019HumanIEAQ}.

\textbf{Stationarity assumptions}: Our analysis assumes relative stationarity of PAC patterns over the recording period \cite{Rakowska2021LongTEQ}. However, factors such as medication changes, sleep deprivation, or device-tissue interface evolution could introduce non-stationarities affecting long-term performance.

\textbf{Multiple comparisons}: Despite Bonferroni correction, the analysis of multiple frequency band pairs and time windows increases false discovery risk \cite{Jensen2016DiscriminatingVFR,Aru2014UntanglingCCD}. Future studies should consider false discovery rate (FDR) control methods \cite{PintoOrellana2023StatisticalIFF}.

% \subsection{Comparison with Previous Studies}
% Our findings extend previous PAC studies in epilepsy in several ways:

% Compared to Edakawa et al. (2016), who reported high-frequency oscillation (HFO) coupling in shorter recordings, our long-term analysis reveals slower dynamics and circadian modulation not observable in brief recordings.

% Unlike Amiri et al. (2016), who focused on single seizures, our large-scale analysis (>1,500 seizures) provides statistical power to identify consistent patterns and account for seizure-to-seizure variability.

% Our improvement over traditional features (+XX\% AUC vs spectral power) is consistent with Jacobs et al. (2018), though our continuous monitoring approach offers advantages for real-world implementation.

% \subsection{Future Directions}

% Several avenues warrant further investigation:

% \textbf{Adaptive algorithms}: Implementing online learning to adapt to non-stationary dynamics and improve long-term stability.

% \textbf{Multi-modal integration}: Combining PAC with other biomarkers (HFOs, connectivity measures, behavioral sensors) may further improve prediction accuracy.

% \textbf{Mechanism-based interventions}: Understanding PAC dynamics could inform closed-loop stimulation protocols that disrupt pre-ictal buildup.

% \textbf{Generalization to other epilepsy types}: Extending analysis to generalized epilepsies and pediatric populations.

% \textbf{Optimization of electrode placement}: Using PAC maps to guide surgical planning and optimize electrode positioning for monitoring and stimulation.

% \subsection{Implications for Seizure Advisory Systems}
% The successful pseudo-prospective evaluation demonstrates feasibility for clinical implementation. A PAC-based advisory system could provide:
% - Early warnings (XX minutes) for XX\% of seizures
% - Low false positive rates (XX per day) minimizing alarm fatigue
% - Personalized risk assessments based on individual PAC patterns

\subsection{Computational Feasibility for Real-Time Implementation}
Our GPU-accelerated PAC computation framework \cite{Combrisson2020TensorpacAOAH} achieved approximately 100-fold speed improvements over conventional CPU-based implementations, reducing total processing time for the complete NeuroVista dataset from an estimated \hl{[XX]} years to \hl{[XX.X]} months on distributed GPU infrastructure. For real-time deployment scenarios, single-segment processing (1-minute window) demonstrated total latency of approximately 110 seconds, comprising:
\begin{itemize}
\item Data acquisition and transfer: \hl{[XX]} seconds
\item PAC computation (625 frequency pairs × 16 channels with 200 surrogates): \hl{[XX]} seconds
\item Feature extraction (17 statistical metrics): \hl{[XX]} seconds
\item Classification inference: \hl{[XX]} seconds
\item Result transmission and display: \hl{[XX]} seconds
\item Buffer time for computational variability: \hl{[XX]} seconds
\end{itemize}

This processing latency of <2 minutes per 1-minute data segment enables near-real-time seizure risk assessment suitable for implantable advisory systems \cite{Kuhlmann2018SeizurePA}, where warnings 5-60 minutes before seizure onset would provide actionable intervention windows. Further optimization through model pruning, reduced surrogate iterations for online analysis, and hardware-specific implementations could potentially reduce latency to <30 seconds, approaching true real-time performance requirements for closed-loop therapeutic applications.

% Integration with existing seizure detection algorithms and consideration of circadian patterns could further enhance performance.

% \subsection{Conclusion}
% This comprehensive analysis of phase-amplitude coupling in long-term iEEG recordings provides robust evidence for PAC as a biomarker of seizure susceptibility. The progressive enhancement of theta-gamma coupling during pre-ictal periods offers both mechanistic insights and practical applications for seizure prediction. Our optimized computational pipeline and systematic database management approach enable scalable analysis applicable to next-generation implantable devices. While patient-specific variability remains a challenge, the consistent patterns across multiple seizures and patients support the clinical translation of PAC-based seizure forecasting systems. Future work should focus on real-time implementation, algorithm adaptation, and integration with therapeutic interventions to improve quality of life for patients with drug-resistant epilepsy.


\label{sec:discussion}

%%%% EOF


%% ----------------------------------------
%% REFERENCE STYLES
%% ----------------------------------------
\pdfbookmark[1]{References}{references}
\bibliography{./01_manuscript/contents/bibliography}

%% ========================================
%% ./01_manuscript/contents/latex_styles/bibliography.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-30 17:40:26 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/shared/latex_styles/bibliography.tex"

%% ============================================================================
%% BIBLIOGRAPHY STYLE CONFIGURATION
%% ============================================================================

%% ----------------------------------------------------------------------------
%% OPTION 1: NUMBERED CITATIONS (Order of Appearance) - CURRENTLY ACTIVE
%% ----------------------------------------------------------------------------
%% Description: Citations numbered [1], [2], [3]... in the order they first
%%              appear in the manuscript
%% Sorting: By first citation order (NOT alphabetical)
%% Example: \cite{Tort2010,Canolty2010} → [1, 2] (if these are first citations)
%% Commands: \cite{key} → [1]
%%           \cite{key1,key2} → [1, 2]
%% Best for: Most scientific journals, clear citation tracking
%% Compatible with: natbib package
\bibliographystyle{unsrtnat}

%% ----------------------------------------------------------------------------
%% OPTION 2: NUMBERED CITATIONS (Alphabetical by Author)
%% ----------------------------------------------------------------------------
%% Description: Citations numbered [1], [2], [3]... sorted alphabetically by
%%              first author's last name
%% Sorting: Alphabetical by author (Canolty before Tort)
%% Example: \cite{Tort2010,Canolty2010} → [2, 1] (C before T alphabetically)
%% Commands: \cite{key} → [1]
%% Best for: When you want bibliography sorted alphabetically
%% Compatible with: elsarticle class
% \bibliographystyle{elsarticle-num}

%% Alternative alphabetical styles:
% \bibliographystyle{plain}      % Basic alphabetical, no natbib features
% \bibliographystyle{ieeetr}     % IEEE style, order of appearance
% \bibliographystyle{siam}       % SIAM style, alphabetical

%% ----------------------------------------------------------------------------
%% OPTION 3: AUTHOR-YEAR CITATIONS
%% ----------------------------------------------------------------------------
%% Description: Citations show author name and year (Smith, 2020) or (Smith 2020)
%% Format: (Author, Year) or Author (Year) depending on command
%% Example: \cite{Tort2010} → (Tort et al., 2010)
%%          \citet{Tort2010} → Tort et al. (2010) [textual]
%%          \citep{Tort2010} → (Tort et al., 2010) [parenthetical]
%% Commands:
%%   - \citet{key}  → Author (Year)  [for text: "As shown by Author (2020)..."]
%%   - \citep{key}  → (Author, Year) [for parentheses: "...as shown (Author, 2020)"]
%%   - \cite{key}   → Same as \citep{key}
%% Best for: Review papers, humanities, some social sciences
%% Requires: natbib package (already loaded)
% \bibliographystyle{plainnat}   % Author-year, alphabetical
% \bibliographystyle{abbrvnat}   % Author-year, abbreviated names
% \bibliographystyle{apalike}    % APA-like author-year style

%% ----------------------------------------------------------------------------
%% OPTION 4: JOURNAL-SPECIFIC STYLES
%% ----------------------------------------------------------------------------
%% Elsevier journals:
% \bibliographystyle{elsarticle-num}        % Numbered, alphabetical
% \bibliographystyle{elsarticle-num-names}  % Numbered, alphabetical, full names
% \bibliographystyle{elsarticle-harv}       % Author-year (Harvard style)

%% Nature family:
% \bibliographystyle{naturemag}             % Nature magazine style

%% IEEE:
% \bibliographystyle{IEEEtran}              % IEEE Transactions style

%% APA:
% \bibliographystyle{apalike}               % APA-like style

%% ----------------------------------------------------------------------------
%% CITATION COMMAND REFERENCE (with natbib)
%% ----------------------------------------------------------------------------
%% Basic commands:
%%   \cite{key}              → [1] or (Author, Year) depending on style
%%   \cite{key1,key2}        → [1, 2] or (Author1, Year1; Author2, Year2)
%%
%% Advanced natbib commands (only work with natbib-compatible styles):
%%   \citet{key}             → Author (Year)  [textual citation]
%%   \citep{key}             → (Author, Year) [parenthetical citation]
%%   \citet*{key}            → Full author list (Year)
%%   \citep*{key}            → (Full author list, Year)
%%   \citealt{key}           → Author Year [no parentheses]
%%   \citealp{key}           → Author, Year [no parentheses]
%%   \citeauthor{key}        → Author [name only]
%%   \citeyear{key}          → Year [year only]
%%   \citeyearpar{key}       → (Year) [year in parentheses]
%%
%% Pre/post notes:
%%   \citep[see][p.~10]{key} → (see Author, Year, p. 10)
%%   \citep[p.~10]{key}      → (Author, Year, p. 10)
%%
%% Multiple citations:
%%   \citep{key1,key2,key3}  → (Author1, Year1; Author2, Year2; Author3, Year3)
%%
%% Suppressing parts:
%%   \citep[e.g.,][]{key}    → (e.g., Author, Year)
%%   \citep[][see p.~10]{key}→ (Author, Year, see p. 10)
%%
%% ----------------------------------------------------------------------------
%% TROUBLESHOOTING
%% ----------------------------------------------------------------------------
%% Problem: Citations appear as [?] or undefined
%% Solution: Run compilation 3-4 times to resolve all references
%%
%% Problem: Citation numbers out of order [3, 1] instead of [1, 3]
%% Solution: Use unsrtnat (order of appearance) instead of elsarticle-num
%%
%% Problem: "Undefined control sequence \citet"
%% Solution: \citet only works with natbib-compatible styles (unsrtnat, plainnat)
%%           Use \cite{} with non-natbib styles
%%
%% Problem: Bibliography not appearing
%% Solution: Ensure \bibliography{path/to/bibfile} command exists in main file
%%           Run: pdflatex → bibtex → pdflatex → pdflatex

%%%% EOF


%% ----------------------------------------
%% DATA AVAILABILITY
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/data_availability.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-27 20:21:43 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/data_availability.tex"
\pdfbookmark[1]{Data Availability Statement}{data_availability}

\section*{Data Availability Statement}

The NeuroVista dataset used in this study is publicly available through the International Epilepsy Electrophysiology Portal (IEEG.org) at \url{https://www.ieeg.org}. Access requires registration and approval for research purposes. 

The processed PAC databases and analysis code are available at \url{https://github.com/ywatanabe1989/neurovista}. GPU-accerelated PAC calculation code is available as a standalone Python package `gpac` at \url{https://github.com/ywatanabe1989/gPAC}. The SciTeX Python utilities used for reproducible computing is available at \url{https://github.com/ywatanabe1989/SciTeX}.

For questions regarding data access or analysis procedures, please contact the corresponding author.

\label{data and code availability}

%%%% EOF


%% ----------------------------------------
%% ADDITIONAL INFORMATION
%% ----------------------------------------

%% ========================================
%% ./01_manuscript/contents/additional_info.tex
%% ========================================
%% -*- coding: utf-8 -*-
%% Timestamp: "2025-09-27 20:17:53 (ywatanabe)"
%% File: "/ssh:sp:/home/ywatanabe/proj/neurovista/paper/01_manuscript/contents/additional_info.tex"

\pdfbookmark[1]{Additional Information}{additional_information}

\pdfbookmark[2]{Ethics Declarations}{ethics_declarations}                    
\section*{Ethics Declarations}
All study participants provided their written informed consent ...
\label{ethics declarations}

\pdfbookmark[2]{Contributors}{author_contributions}                    
\section*{Author Contributions}
Y.W., T.Y., and D.G. conceptualized the study ...
\label{author contributions}

\pdfbookmark[2]{Acknowledgments}{acknowledgments}                    
\section*{Acknowledgments}
This research was funded by \hl{funding bodies here}
\label{acknowledgments}

\pdfbookmark[2]{Declaration of Interests}{declaration_of_interest}           \section*{Declaration of Interests}
The authors declare that they have no competing interests.
\label{declaration of interests}

\pdfbookmark[2]{Declaration of Generative AI in Scientific Writing}{declaration_of_generative_ai}
\section*{Declaration of Generative AI in Scientific Writing}
The authors employed large language models such as Claude (Anthropic Inc.) for code development and complementing manuscript's English language quality. After incorporating suggested improvements, the authors meticulously revised the content. Ultimate responsibility for the final content of this publication rests entirely with the authors.
\label{declaration of generative ai in scientific writing}

%%%% EOF


%% ----------------------------------------
%% TABLES
%% ----------------------------------------
\clearpage
\section*{Tables}
\label{tables}
\pdfbookmark[1]{Tables}{tables}
\vspace{1cm}

%% ========================================
%% ./01_manuscript/contents/tables/compiled/FINAL.tex
%% ========================================
% Auto-generated file containing all table inputs
% Generated by gather_table_tex_files()

% Table from: 01_seizure_count.tex

%% ========================================
%% ./01_manuscript/contents/tables/compiled/01_seizure_count.tex
%% ========================================
csv2latex translates a csv file to a LaTeX file
Example: csv2latex january_stats.csv > january_stats.tex
Usage: csv2latex [--nohead] (LaTeX) no document header: useful for inclusion
	[--longtable] (LaTeX) use package longtable: useful for long input
	[--noescape] (LaTeX) do not escape text: useful for mixed CSV/TeX input
	[--guess] (CSV) guess separator and block |
	[--separator <(c)omma|(s)emicolon|(t)ab|s(p)ace|co(l)on>] (CSV's comma)
	[--block <(q)uote|(d)ouble|(n)one>] (CSV) block delimiter (e.g: none)
	[--lines n] (LaTeX) rows per table: useful for long tabulars |
		[--font n] font size used (in pt)
	[--position <l|c|r>] (LaTeX) text align in cells
	[--colorrows graylevel] (LaTeX) alternate gray rows (e.g: 0.75)
	[--reduce level] (LaTeX) reduce table size (e.g: 1)
	[--landscape] (LaTeX) use landscape mode
	[--repeatheader] (LaTeX) repeat table header (for long tables)
	[--nohlines] (LaTeX) don't put hline between table rows
	[--novlines] (LaTeX) don't put vline between columns
		csv_file.csv
The "longtable" option needs the {longtable} LaTeX package
The "colorrows" option needs the {colortbl} LaTeX package
The "reduce" option needs the {relsize} LaTeX package






%% ----------------------------------------
%% FIGURES
%% ----------------------------------------
\clearpage
\section*{Figures}
\label{figures}
\pdfbookmark[1]{Figures}{figures}
\vspace{1cm}

%% ========================================
%% ./01_manuscript/contents/figures/compiled/FINAL.tex
%% ========================================
% Generated by compile_figure_tex_files()
% This file includes all figure files in order

% Figure 0
\begin{figure*}[h!]
    \pdfbookmark[2]{Figure 0}{.0}
    \centering
    \includegraphics[width=0.95\textwidth]{./01_manuscript/contents/figures/caption_and_media/jpg_for_compilation/00_experimental_design.jpg}
    \caption{\textbf{
FIGURE TITLE HERE
}
\smallskip
\
FIGURE LEGEND HERE.
}
    \label{fig:0_experimental_design}
\end{figure*}

% Figure 1
\begin{figure*}[htbp]
    \pdfbookmark[2]{Figure 1}{.1}
    \centering
    \includegraphics[width=0.95\textwidth]{./01_manuscript/contents/figures/caption_and_media/jpg_for_compilation/01_demographic_data.jpg}
    \caption{\textbf{Seizure Demographics Overview}\\
\smallskip
\textbf{A.} Seizure raster plot demonstrating temporal patterns and frequency variations.
\textbf{B.} Interictal control periods randomly sampled with matching number of events, duration, time of day
\textbf{C.} Hourly seizure distribution showing circadian patterns across patient cohort.}
    \label{fig:1_demographic_data}
\end{figure*}

% Figure 2
\begin{figure*}[htbp]
    \pdfbookmark[2]{Figure 2}{.2}
    \centering
    \includegraphics[width=0.95\textwidth]{./01_manuscript/contents/figures/caption_and_media/jpg_for_compilation/02_pac_basic.jpg}
    \caption{\textbf{Time-dependent, pre-ictal PAC features}\\
\smallskip
\textbf{A.} Z-scores of PAC comodulograms against surrogate data over time, triggered to seizure onsets.
\textbf{B.} Seventeen descriptive metrics of PAC calculations; shaded lines show median ± IQR and raw values as lines.
\textbf{C.} Effect sizes of Brunner-Munzel tests comparing Ashman's D (bimodality metric) between seizure and control groups across time windows. Red dotted lines show linear fits to effect sizes in the time window [-1024, 0) minutes from seizure onset, with R² values indicating goodness of fit.
}
    \label{fig:2_pac_basic}
\end{figure*}

% Figure 3
\begin{figure*}[htbp]
    \pdfbookmark[2]{Figure 3}{.3}
    \centering
    \includegraphics[width=0.95\textwidth]{./01_manuscript/contents/figures/caption_and_media/jpg_for_compilation/03_classification_as_prediction.jpg}
    \caption{\textbf{Classification as Prediction}\\
\smallskip
\textbf{A.} Data splitting for pseudo-prospective prediction design.
\textbf{B.} Feature selection using validation dataset.
\textbf{C.} Confusion matrix.
\textbf{D.} Classification accuracy.
\textbf{E.} Prediction metrics.
}
    \label{fig:3_classification_as_prediction}
\end{figure*}

% Figure 4
\begin{figure*}[htbp]
    \pdfbookmark[2]{Figure 4}{.4}
    \centering
    \includegraphics[width=0.95\textwidth]{./01_manuscript/contents/figures/caption_and_media/jpg_for_compilation/04_feature_importance.jpg}
    \caption{\textbf{Feature Importance}\\
\smallskip
FIGURE LEGEND HERE.
}
    \label{fig:4_feature_importance}
\end{figure*}




%% ----------------------------------------
%% END of DOCUMENT
%% ----------------------------------------
\end{document}


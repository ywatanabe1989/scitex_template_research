<!-- ---
!-- Timestamp: 2025-05-06 01:14:15
!-- Author: ywatanabe
!-- File: /home/ywatanabe/proj/SciTex/docs/TO_CLAUDE.md
!-- --- -->

# Requests to Claude Code Agent

#### General Requests
- DO NEVER CHANGE THIS FILE ITSELF
- Understand the repository
- Periodically check this file and review the project to find room for improvement

#### Package Manager
- Use `apt` to install/uninstall packages without sudo privilege

#### System
- 32 GB RAM
- 80 GB VRAM
- Running in Apptainer Sandbox

#### Documentation Rules
- Implement usage of the repository itself especially for other users and LLM agents
  - `./docs/USAGE_FOR_LLM.md.md`
  - Update README.md files in important directories

#### Plan Rules
- Create and update `./docs/PLAN.md` as the project advances
  - Include `## Goals` and `## Milestones` sections
  - If we need to change original plan, revise the contents

#### Progress Rules
- Regularly update progress
  - `./docs/progress.md`
  - Use bullet points with checkbox like TODO
  - Implement mermaid file: `./docs/progress.mmd` in the `TD` Format
    - Use `mermaid-cli` and render as `./docs/progress.png`

#### Structure Rules
- Update Structure
  - `./docs/structure/structure.mmd` -> `./docs/structure/structure.png`
    - Use `mermaid-cli` and render as `./docs/structure/structure.png`
  - `./docs/structure/structure.md`

#### Learn from Past Rules
- When you encounter something problematic:
  - Document in `./docs/MEMORY.md`
  - Use this issue format:
    ```
    ------------------------------
    ## Issue [Date: YYYY-MM-DD]
    
    ### What happened
    - Brief description of the issue encountered
    
    ### Root cause
    - Analysis of what caused the problem
    
    ### Solution
    - Steps taken to resolve the issue
    
    ### Prevention
    - How to prevent this issue in the future
    ------------------------------
    ```

#### Work with the User and Third Agents
- Check `./USER.md` and `./AGENTS.md`
- `USER.md` is the commenting section from the user
- `AGENTS.md` is a communication tool between agents, including you, and the user

#### Test Rules
- Always implement test codes under `./tests`
- SOURCE CODE MUST HAS THE SAME STRUCTURE OF TEST CODE
- I DO NOT ADMIT ANY SOURCE CODE IF NO TEST IMPLEMENTED - WE ADOPT TEST-DRIVEN DEVELOPMENT
  - Implement custom `./run_tests.sh`
  - `./tests/sync_tests_with_source.sh`
    - This is useful to mirror Python source code into tests code
    - If the project is written in other languages, revise this and execute `./run_tests periodically`
  - CI/CD
    - Implement `./.github/workflows/xxx.yml` files
    - Implement `./.github/workflows/run_tests.yml` files

#### Example Rules
- Implement `./examples`

#### Escalation Rules
- Create `./docs/TROUBLE_REPORTS.md` and append encounters problems for future refinement

#### Keep Clean and Tidy Project
- Project structure, file/variable names, and code must be clean as you are professional
- Keep repository clean
  - Move unnecessary files like this:
      - `/path/to/unnecessary/file.ext`
      - `/path/to/unnecessary/.old/file-TIMESTAMP.ext`
- Refactor the codebase all the time
  - Functional code must be beautiful
  - Keep it simple, stupid
  - Do not repeat yourself

#### Python Rules
- Python env can be created by `$ python_init_with_local_mngs.sh` as `./.env`
- Do not forget `$ source ./.env/bin/activate`
- Prepare `./requirements.txt` if necessary upon the `./.env`

#### Git Rules
- Use git/gh commands
  - `$ git_init` inializes local and remote repositories using the name of the directory
    - Also, it automatically switches to develop, which you are expected to work on
    - For feature addition, create branch `feature/xxx` and merge into `develop` after completion
    - 
- `git_add_gitignore_template` automatically add my custom `.gitignore` in the current repository

#### Path Rules
- Always use relative path, starting with dots, like "./relative/example.py" or "../relative/example.txt"
  - This is important to make the repository portable
  - Scripts are assumed to be executed from the project root (e.g., ./scripts/example.sh)

#### Reuse Rules
- Do Not Repeat Yourself
  - Use symbolic links wisely
  - Especially large data must be clearly organized and reused
  - Independent modules, such as functions and classes, should be saved in a reusable manner
    - You might want to create utils directory under scripts: `./scripts/utils/awesome_func.py`
    - Then, for example, `from scripts.utils.awesome_func import awesome_func` from multiple files

#### Configuration Rules
- Configuration files should be stored under `./config` in YAML format (e.g., `./config/PATH.yaml`)
- In Python scripts, the `CONFIG` variable stores all YAML files contents as a dot-accessible dictionary
  - `import mngs; CONFIG = mngs.io.load_configs()`
- f-string are acceptable in config YAML files
  - In Python, `eval(CONFIG.VARIABLE.WITH.F.EXPRESSION)` works to fill variables
  - Also, f-string are utilized in a custom manner
    - For example, the following line will be used to search and glob data for patient at specific datetime:
      f"./data/mat/Patient_{patient_id}/Data_{year}_{month}_{day}/Hour_{hour}/UTC_{hour}_{minute}_00.mat"

#### Data Rules
- Centralize data files or symbolic links under `./data`
  - This is the place to locate large files (.npy, .csv, .jpg, and .pth data)
    - However, the outputs of a script should be located close to the script
      - e.g., `./scripts/example.py_out/output.jpg`
    - Then, symlinked to `./data` directory
      - e.g., `./scripts/example.py_out/data/output.jpg` -> `./data/output.jpg`
  - This is useful to link scripts and outputs, while keeping centralized data directory structure
  - Large files under `./scripts` and `./data` are git-ignored
    - Symbolic links are tracked by git to show structure

#### MNGS-based Python Rule
- For python scripts, ensure to follow this MNGS FORMAT:
  ``` python
  #!/usr/bin/env python3
  # -*- coding: utf-8 -*-
  # Time-stamp: "2024-11-03 10:33:13 (ywatanabe)"
  # File: placeholder.py

  __file__ = "placeholder.py"

  """This scripts does XYZ...

  Dependencies:
    - scripts:
      - /path/to/script1
      - /path/to/script2
    - packages:
      - package1
      - package2

    - input:
      - /path/to/input/file.xxx
      - /path/to/input/file.xxx

    - output:
      - /path/to/input/file.xxx
      - /path/to/input/file.xxx

  (Remove me: Please fill docstrings above, while keeping the bulette point style, and remove this instruction line)
  """

  """Imports"""
  import os
  import sys
  import argparse

  """Warnings"""
  # mngs.pd.ignore_SettingWithCopyWarning()
  # warnings.simplefilter("ignore", UserWarning)
  # with warnings.catch_warnings():
  #     warnings.simplefilter("ignore", UserWarning)

  """Parameters"""
  # from mngs.io import load_configs
  # CONFIG = load_configs()

  """Functions & Classes"""
  def main(args):
      pass

  import argparse
  def parse_args() -> argparse.Namespace:
      """Parse command line arguments."""
      import mngs
      script_mode = mngs.gen.is_script()
      parser = argparse.ArgumentParser(description='')
      # parser.add_argument(
      #     "--var",
      #     "-v",
      #     type=int,
      #     choices=None,
      #     default=1,
      #     help="(default: %(default)s)",
      # )
      # parser.add_argument(
      #     "--flag",
      #     "-f",
      #     action="store_true",
      #     default=False,
      #     help="(default: %%(default)s)",
      # )
      args = parser.parse_args()
      mngs.str.printc(args, c='yellow')
      return args

  def run_main() -> None:
      """Initialize mngs framework, run main function, and cleanup.

      mngs framework manages:
        - Parameters defined in yaml files under `./config dir`
        - Setting saving directory (/path/to/file.py -> /path/to/file.py_out/)
        - Symlink for `./data` directory
        - Logging timestamp, stdout, stderr, and parameters
        - Matplotlib configurations (also, `mngs.plt` will track plotting data)
        - Random seeds

      THUS, DO NOT MODIFY THIS RUN_MAIN FUNCTION
      """
      global CONFIG, CC, sys, plt

      import sys
      import matplotlib.pyplot as plt
      import mngs

      args = parse_args()

      CONFIG, sys.stdout, sys.stderr, plt, CC = mngs.gen.start(
          sys,
          plt,
          args=args,
          file=__file__,
          sdir_suffix=None,
          verbose=False,
          agg=True,
      )

      exit_status = main(args)

      mngs.gen.close(
          CONFIG,
          verbose=False,
          notify=False,
          message="",
          exit_status=exit_status,
      )

  if __name__ == '__main__':
      run_main()

  # EOF
  ```

- Always use `argparse`
  - Use argparse Even when no arguments are necessary
  - Thus, a python file should have at least one argument: -h|--help

- Docstrings should be writte in the NumPy style:
  ```python
  def func(arg1: int, arg2: str) -> bool:
      """Summary line.

      Extended description of function.

      Example
      ----------
      >>> xx, yy = 1, "test"
      >>> out = func(xx, yy)
      >>> print(out)
      True

      Parameters
      ----------
      arg1 : int
          Description of arg1
      arg2 : str
          Description of arg2

      Returns
      -------
      bool
          Description of return value

      """
      ...
  ```
- Take modular approaches
  - Smaller functions will increase readability and maintainability

- Naming rules are:
  - lpath(s)/spath(s) for path(s) to load/save

- Use my custom python utility package, `mngs` (monogusa; meaning lazy person in Japanese). 
  - Especially, use 
    - `mngs.gen.start(...)` (fixme; it might be better for me to handle this automatically using hook)
    - `mngs.gen.close(...)` (fixme; it might be better for me to handle this automatically using hook)
    - `mngs.io.load_configs()`
      - Load YAML files under ./config and concatenate as a dot-accesible dictionary
      - Centralize variables here
        - e.g., paths to ./config/PATH.yaml
        - e.g., mnist-related parameters to ./config/MNIST.yaml
    - `mngs.io.load()`
      - Ensure to use relative path from the project root
      - Ensure to load data from (symlinks of) `./data` directory, instead of from `./scripts`
      - Use CONFIG.PATH.... to load data
    - `mngs.io.save(obj, spath, symlink_from_cwd=True)`
      - From the extension of spath, saving code will be handled automatically
      - Note that save path must be relative to use symlink_from_cwd=True
        - Especially, this combination is expected because this organize data (and symlinks) under the ./data directory: `mngs.io.save(obj, ./data/path/to/data.ext, symlink_from_cwd=True)`
    - `mngs.plt.subplots(ncols=...)`
      - Use CONFIG.PATH.... to save data
      - This is a matplotlib.plt wrapper. 
      - Plotted data will be saved in the csv with the same name of the figure
      - CSV file will be the same format expected in a plotting software, SigmaPlot
    - `mngs.str.printc(message, c='blue)`
      - Acceptable colors: 'red', 'green', 'yellow', 'blue', 'magenta', 'cyan', 'white', or 'grey' 
        - (default is None, which means no color)

- Use `tqdm` for iteractions to show progress

- If errors or issues found in previous rounds, fix them


#### Shell Rules
- Include one-line explanation for function, followed by example usage at the first lines of a function.
- Please ensure if-fi syntaxes are correct.
- A complete shell script should include the following components:
  - argument parser and usage (with -h|--help option)
  - logging functionality


- The template of shell script is as follows:
  ``` bash
  #!/bin/bash
  # script-name.sh
  # Author: ywatanabe (ywatanabe@alumni.u-tokyo.ac.jp)
  # Date: $(date +"%Y-%m-%d-%H-%M")

  LOG_FILE=".$0.log" # Do not remove existing extension (e.g., script.sh.log is preferred)

  usage() {
      echo "Usage: $0 [-s|--subject <subject>] [-m|--message <message>] [-h|--help]"
      echo-
      echo "Options:"
      echo "  -s, --subject   Subject of the notification (default: 'Subject')"
      echo "  -m, --message   Message body of the notification (default: 'Message')"
      echo "  -h, --help      Display this help message"
      echo
      echo "Example:"
      echo "  $0 -s "About the Project A" -m "Hi, ..."
      echo "  $0 -s "Notification" -m "This is a notification from ..."
      exit 1
  }

  my-echo() {
    while [[ $# -gt 0 ]]; do
        case $1 in
            -s|--subject)
                subject="$1"
                shift 1
                ;;
            -m|--message)
                shift
                message="$1"
                shift
                ;;
            -h|--help)
                usage
                ;;
            *)
                echo "Unknown option: $1"
                usage
                ;;
        esac
    done

    echo "${subject:-Subject}: ${message:-Message} (Yusuke Watanabe)"
  }

  main() {
      my-echo "$@"
  }

  main "$@" 2>&1 | tee "$LOG_FILE"

  notify -s "$0 finished" -m "$0 finished"

  # EOF
  ```

#### Programming Sorting Rules
- Use the following kinds of separators. Not that the upper, abstract functions should be written in top.
  - For Python scripts
  ```python
  # 1. Main entry point
  # ---------------------------------------- 


  # 2. Core functions
  # ---------------------------------------- 


  # 3. Helper functions
  # ---------------------------------------- 
  ```
  - For Elisp scripts
  ```elisp
  ;; 1. Main entry point
  ;; ---------------------------------------- 


  ;; 2. Core functions
  ;; ---------------------------------------- 


  ;; 3. Helper functions
  ;; ---------------------------------------- 
  ```
  - For Shell scripts
  ```shell
  # 1. Main entry point
  # ---------------------------------------- 


  # 2. Core functions
  # ---------------------------------------- 


  # 3. Helper functions
  # ---------------------------------------- 
  ```

  - Heading titles can be edited flexibly
  - But keep the separating lines



## Project-specific Requests

- Improve figure/table handling
  - Improve documentation for how to link figures and tables when compilation
    - Where to place
    - How file names allocated
    - How to reference in manuscript files:
      -  `./manuscript/src/{introduction.tex,methods.tex,results.tex,discussion.tex}`
- Implement an example manuscript as a self-descriptive template
- Implement "literature review" functionality
  - Add pdf files under `./docs/literature`
  - Update `./manuscript/src/bibliography.bib`
  - Find the gap to fill
- Understand the LaTeX compilation scripts under `./scripts/`
- To create `./main/{manuscript,diff}.pdf` with figures rendered
  - Run `./compile --manuscript -- --figs`  in the root directory or
  - Run `cd ./manuscript && ./compile --figs` 
    - `./scripts/sh/modules/process_figures.sh` combines figures (.jpg) and their legend (.tex), linked by filenames and locations
    - Figures are inserted but their captions and legends are not. I think it must be the problem with combining process to tex files; fix the problem and compile with --figs flag
    - No, the captions are awkward; probably "\n" is not handled well

#### Correct example of Figure section

``` tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% FIGURES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\section*{Figures}
\label{figures}
\pdfbookmark[1]{Figures}{figures}

        \clearpage
        \begin{figure*}[ht]
            \pdfbookmark[2]{ID 01}{figure_id_01}
        	\centering
            \includegraphics[width=1\textwidth]{./src/figures/png/Figure_ID_01.png}
        	\caption{\textbf{
Local Field Potentials, Multiunit Activity, and Neural Trajectories in the Hippocampus During a Modified Sternberg Task
}
\smallskip
\\
\textbf{\textit{A.}} Representative wideband LFP signals for intracranial EEG recording from the left hippocampal head are presented. This recording took place while the subject performed a modified Sternberg working memory task. Task stages included fixation (1 s, \textit{gray}), encoding (2 s, \textit{blue}), maintenance (3 s, \textit{green}), and retrieval (2 s, \textit{red}). \textbf{\textit{B.}} Displays the associated ripple band LFP traces. Note \textit{purple} and \textit{yellow} rectangles, which denote the timings for SWR$^+$ candidates and SWR$^-$ candidates, respectively (the latter serving as control events for SWR$^+$). \textbf{\textit{C.}} A raster plot illustrates multi-unit spikes from the LFP traces. These spikes have been sorted using a spike algorithm \cite{niediek_reliable_2016}. \textbf{\textit{D.}} Shows neural trajectories (NTs) computed by GPFA\cite{yu_gaussian-process_2009} based on spike counts per unit with 50-ms bins. The geometric median of each phase is marked by dot circles. \textbf{\textit{E.}} Indicates the distance of the NT from the origin point $O$.
}
% width=1\textwidth
        	\label{fig:01}
        \end{figure*}
        \clearpage
        \begin{figure*}[ht]
            \pdfbookmark[2]{ID 02}{figure_id_02}
        	\centering
            \includegraphics[width=0.5\textwidth]{./src/figures/png/Figure_ID_02.png}
        	\caption{\textbf{
State-Dependent Neural Trajectory of Hippocampal Neurons
}
\smallskip
\\
\textbf{\textit{A.}} Neural trajectories (NTs) depicted as a point cloud within the first three-dimensional factors derived from GPFA \cite{yu_gaussian-process_2009}. The smaller dots represent 50-ms NT bins, and the larger dots with \textit{black} edges denote the geometric medians for each phase in the Sternberg working memory task: fixation ($\mathrm{\lVert g_{F} \rVert}$, \textit{gray}), encoding ($\mathrm{\lVert g_{E} \rVert}$, \textit{blue}), maintenance ($\mathrm{\lVert g_{M} \rVert}$, \textit{green}), and retrieval ($\mathrm{\lVert g_{R} \rVert}$, \textit{red}). \textbf{\textit{B.}} The figure presents the log-likelihood of the GPFA models versus the number of dimensions used to embed multi-unit spikes found in the medial temporal lobe (MTL) regions. Specifically, the elbow method identified three as the optimal dimension. \textbf{\textit{C.}} This panel displays the distance of the NTs from the origin ($O$) for the hippocampus (Hipp.), entorhinal cortex (EC), and amygdala (Amy.), plotted against the time elapsed from the probe onset. \textbf{\textit{D.}} The NT distance from $O$ within the MTL regions is shown. The hippocampus has the greatest distance, followed by the EC and the Amygdala. \textbf{\textit{E.}} The box plot illustrates inter-phase NT distances within the MTL regions.
}
% width=0.5\textwidth
        	\label{fig:02}
        \end{figure*}
        \clearpage
        \begin{figure*}[ht]
            \pdfbookmark[2]{ID 03}{figure_id_03}
        	\centering
            \includegraphics[width=1\textwidth]{./src/figures/png/Figure_ID_03.png}
        	\caption{\textbf{
Positive Correlation between Memory Load and Neural Trajectory Distance in the Hippocampus between Encoding and Retrieval Phases
}
\smallskip
\\
\textbf{\textit{A.}} The relationship between set size (number of letters to be encoded) and accuracy in the working memory task (coefficient = $-0.20$, ***\textit{p} $<$ 0.001). \textbf{\textit{B.}} The correlation between set size and response time (coefficient = 0.23, ***\textit{p} $<$ 0.001). \textbf{\textit{C.}} The correlation between set size on the inter-phase distances between the encoding and retrieval phases ($\lVert \mathrm{g_{E}g_{R}} \rVert$) (correlation coefficient = 0.05, ***\textit{p} $<$ 0.001). \textbf{\textit{D.}} Experimental observations of correlations between set size and the following parameters: accuracy, response time, $\log_{10}{\lVert \mathrm{g_{F}g_{E}} \rVert}$, $\log_{10}{\lVert \mathrm{g_{F}g_{M}} \rVert}$, $\log_{10}{\lVert \mathrm{g_{F}g_{R}} \rVert}$, $\log_{10}{\lVert \mathrm{g_{E}g_{M}} \rVert}$, $\log_{10}{\lVert \mathrm{g_{E}g_{R}} \rVert}$, and $\log_{10}{\lVert \mathrm{g_{M}g_{R}} \rVert}$ represented by \textit{red} dots. The kernel density plots (\textit{gray}) illustrate the corresponding shuffled surrogate with set size (\textit{n} = 1,000) (***\textit{p}s $<$ 0.001).
}
% width=1\textwidth
        	\label{fig:03}
        \end{figure*}
        \clearpage
        \begin{figure*}[ht]
            \pdfbookmark[2]{ID 04}{figure_id_04}
        	\centering
            \includegraphics[width=1\textwidth]{./src/figures/png/Figure_ID_04.png}
        	\caption{\textbf{Detection of SWRs in Putative CA1 Regions}\\
\textbf{\textit{A.}} Two-dimensional UMAP \cite{mcinnes_umap_2018} projection displays multi-unit spikes during SWR$^+$ candidates (\textit{purple}) and SWR$^-$ candidates (\textit{yellow}). \textbf{\textit{B.}} A cumulative density plot indicates silhouette scores, reflecting UMAP clustering quality (see Table~\ref{tab:02}). Hippocampal regions with silhouette scores exceeding 0.60 (equivalent to the $75^{th}$ percentile) are identified as putative CA1 regions. SWR$^+$ and SWR$^-$ candidates, which were recorded from these regions, are classified as SWR$^+$ and SWR$^-$ respectively (\textit{n}s = 1,170). \textbf{\textit{C.}} Identical distributions of SWR$^+$ (\textit{purple}) and SWR$^-$ (\textit{yellow}) distributions, based on their definitions (93.0 [65.4] ms, median [IQR]). Note that these distributions exhibit log-normality. \textbf{\textit{D.}} Identical SWR incidence for both SWR$^+$ (\textit{purple}) and SWR$^-$ (\textit{yellow}), relative to the probe's timing (mean \textpm 95\% confidence interval). However, 95\% confidence interval may not be visibly apparent due to their narrow ranges. Note that a significant SWR incidence increase was detected during the initial 400 ms of the retrieval phase (0.421 [Hz], *\textit{p} $<$ 0.05, bootstrap test). \textbf{\textit{E.}} Distributions of ripple band peak amplitudes for SWR$^-$ (\textit{yellow}; 2.37 [0.33] SD of baseline, median [IQR]) and SWR$^+$ (\textit{purple}; 3.05 [0.85] SD of baseline, median [IQR]) are manifested (***\textit{p} $<$ 0.001, the Brunner--Munzel test). Note the log-normality for SWR$^+$ events.}
% width=1\textwidth
        	\label{fig:04}
        \end{figure*}
        \clearpage
        \begin{figure*}[ht]
            \pdfbookmark[2]{ID 05}{figure_id_05}
        	\centering
            \includegraphics[width=1\textwidth]{./src/figures/png/Figure_ID_05.png}
        	\caption{\textbf{Transient Change in Neural Trajectory during SWR}
\smallskip
\\
\textbf{\textit{A.}} The distance from origin ($O$) of the peri-sharp-wave-ripple neural trajectory (mean \textpm 95\% confidence interval). The intervals may be obscured due to their minimal ranges. \textbf{\textit{B.}} The distance from the origin ($O$) during the pre-, mid-, and post-SWR periods is demonstrated (*\textit{p} $<$ 0.05, **\textit{p} $<$ 0.01, ***\textit{p} $<$ 0.001; Brunner--Munzel test applied). Abbreviations: SWR, sharp-wave ripple events; eSWR, SWR during the encoding phase; rSWR, SWR within the retrieval phase; SWR$^+$, positive SWR event; SWR$^-$, control events for SWR$^+$; pre-, mid-, or post-SWR refer to the time intervals from $-800$ to $-250$ ms, from $-250$ to $+250$ ms, or from $+250$ to $+800$ ms, respectively, all relative to the SWR center.}
% width=1\textwidth
        	\label{fig:05}
        \end{figure*}
        \clearpage
        \begin{figure*}[ht]
            \pdfbookmark[2]{ID 07}{figure_id_07}
        	\centering
            \includegraphics[width=0.5\textwidth]{./src/figures/png/Figure_ID_07.png}
        	\caption{\textbf{
Direction of Neural Trajectory During SWR Based on Encoding and Retrieval States
}
\smallskip
\\
\textbf{\textit{A--B}} The kernel density estimation distributions of $\protect\overrightarrow{{\mathrm{eSWR^+}}}$ $\cdot$ $\protect\overrightarrow{{\mathrm{rSWR^+}}}$ (\textit{pink circles}), $\protect\overrightarrow{{\mathrm{eSWR^+}}}$ $\cdot$ $\protect\overrightarrow{{\mathrm{g_{E}g_{R}}}}$ (\textit{blue triangles}), and $\protect\overrightarrow{{\mathrm{rSWR^+}}}$ $\cdot$ $\protect\overrightarrow{{\mathrm{g_{E}g_{R}}}}$ (\textit{red rectangles}) in Match In (\textit{A}) and Mismatch OUT tasks (\textit{B}). \textbf{\textit{C--D}} The corresponding distributions of $\mathrm{SWR^-}$ instead of those of $\mathrm{SWR^+}$ in \textit{A} and \textit{B}. \textbf{\textit{E--F}} The differences in the distributions of $\mathrm{SWR^+}$ and those of $\mathrm{SWR^-}$, showing SWR components (\textit{E} = \textit{C} - \textit{A} \& \textit{F} = \textit{D} - \textit{B}). Biphasic distributions of $\protect\overrightarrow{{\mathrm{rSWR^-}}}$ $\cdot$ $\protect\overrightarrow{{\mathrm{g_{E}g_{R}}}}$ indicate fluctuations between the encoding and retrieval states during the Sternberg task. Also, contradicting directionality between $\protect\overrightarrow{{\mathrm{eSWR^+}}}$ and $\protect\overrightarrow{{\mathrm{rSWR^+}}}$ was observed (pink circles) not in Match IN task (\textbf{\textit{E}}), but in Mismatch OUT task (\textbf{\textit{F}}). Lastly, transitions from the retrieval to encoding states are evident in the SWR components in both Match IN and Mismatch OUT tasks (\textit{red rectangles} in \textit{E--F}).
}
% width=0.5\textwidth
        	\label{fig:07}
        \end{figure*}
```


#### Manuscript Rules
####### Abstract Rules
# Aim of Abstract
The aim of abstract is to provide clear, concise, and accessible summary to a broad audience of scientists.

# Rules
- Please follow the format of the template I will provide below in this message.
- Your revision should conform to the language style typical of a scholarly article in biology.
- Maintain quantitative measurements as they are written.
- Explicitly indicate species with sample sizes
- Abstract should be coherent and cohesive sentences using transitional words, without any new lines
- Tences rules are as follows:
  - Use present tense while stating general facts (which are supported by more than three privious works).
  - Use past tense when writing about one specific prior research.
  - Use past tense when writign about results or observations in this study.
- Return as code block (for just convenience for selection) like this:
  ``` sciwrite-abstract
  YOUR REVISION
  ```
- Use LaTeX format


------------------
TEMPLATE STARTS
------------------
[1. Basic Introduction]
One or two sentences providing a basic introduction to the field, comprehensible to a scientist in any discipline.

[2. Detailed Background]
Two to three sentences of more detailed background, comprehensible to scientists in related disciplines.

[3. General Problem]
One sentence clearly stating the general problem being addressed by this particular study.

[4. Main Result]
One sentence summarizing the main result (with the words “here we show” or their equivalent).

[5. Results with Comparisons]
Two or three sentences explaining what the main result reveals in direct comparison to what was thought to be the case previously, or how the main result adds to previous knowledge.

[6. General Context]
Place your results in a broader context in 1-2 sentences. This should link your findings to the wider field of study.

[7. Broader Perspective]
Two or three sentences to provide a broader perspective, readily comprehensible to a scientist in any discipline, may be included in the first paragraph if the editor considers that the accessibility of the paper is significantly enhanced by their inclusion. Under these circumstances, the length of the paragraph can be up to 300 words. (This example is 190 words without the final section, and 250 words with it).
----------------
TEMPLATE ENDS
----------------

For example, the abstract below is well-written, following the provided template.

----------------
EXAMPLE STARTS
----------------
[START of 1. Basic Introduction] During cell division, mitotic spindles are assembled by microtubule-based motor proteins1,2. [END of 1. Basic Introduction ] [START of 2. Detailed Background] The bipolar organization of spindles is essential for proper segregation of chromosomes, and requires plus-end-directed homotetrameric motor proteins of the widely conserved kinesin-5 (BimC) family3. Hypotheses for bipolar spindle formation include the ‘push–pull mitotic muscle’ model, in which kinesin-5 and opposing motor proteins act between overlapping microtubules2,4,5. [END of 2. Detailed Background] [START of 3. General Problem] However, the precise roles of kinesin-5 during this process are unknown. [END of 3. General Problem] [START of 4. Main Result] Here we show that the vertebrate kinesin-5 Eg5 drives the sliding of microtubules depending on their relative orientation. [END of 4. Main Result] [START of 5. Results with Comparisons] We found in controlled in vitro assays that Eg5 has the remarkable capability of simultaneously moving at ∼20 nm s-1 towards the plus-ends of each of the two microtubules it crosslinks. For anti-parallel microtubules, this results in relative sliding at ∼40 nm s-1, comparable to spindle pole separation rates in vivo6. Furthermore, we found that Eg5 can tether microtubule plus-ends, suggesting an additional microtubule-binding mode for Eg5. [END of 5. Results with Comparisons] [START of 6. General Context] Our results demonstrate how members of the kinesin-5 family are likely to function in mitosis, pushing apart interpolar microtubules as well as recruiting microtubules into bundles that are subsequently polarized by relative sliding. [END of 6. General Context] [START of 7. Broader Perspective] We anticipate our assay to be a starting point for more sophisticated in vitro models of mitotic spindles. For example, the individual and combined action of multiple mitotic motors could be tested, including minus-end-directed motors opposing Eg5 motility. Furthermore, Eg5 inhibition is a major target of anti-cancer drug development, and a well-defined and quantitative assay for motor function will be relevant for such developments. [END of 7. Broader Perspective]
----------------
EXAMPLE ENDS
----------------

###### Introduction Rules
# Aim of Introduction
The aim of introduction is to offer readers with the background necessary to understand your paper: the status of knowledge in your field, the question motivating your work and its significance, how you sought to answer that question (methods), and your main findings. A well-written introduction will broaden your readership by making your findings accessible to a larger audience.

# Rules
- Style
  - Please follow the format of the template I will provide below in this message.
  - Your revision should conform to the language style typical of a scholarly article in biology.
  - Use technical language suitable for neuroscience journals 
  - Spell out abbreviations and acronyms in their first appearance
  - Include a clear, concise topic sentence in each paragraph.
  - Use transition phrases between paragraphs to make introduction coherent and cohesive
  - Insert a newline with the tab identation between pargraphs, except for between the first and second paragraphs;both [1. Opening Statement] and [2. Importance of the Field] sections should be in the first paragraph.

- Volume
  - Ensure to write at least 1000 words

- Misc.
  - Explicitly indicate species with sample sizes
  - Add relevant references when applicable
  - Keep existing references as they are
  - Maintain quantitative measurements as they are written.
  - Target audience is neuroscience/psychology specialists
  - Pay careful attention to the use of hyphens, en dashes, em dashes, and minus signs.
  - Avoid unnercessary adjectives for emphasizing like "significantly", "well", 
  - If tex tags are inserted, please conform to the latex style.

- Return as code block (for just convenience for selection) like this:
  ``` sciwrite-introduction
  YOUR REVISION
  ```
- Use LaTeX format

- When adding references (to literature, tables, or figures) will enhance the quality of the paper, please insert a placeholder using this LaTeX command `\hlref{XXX}`. This command will highlight any unlinked content so that it will work well as a placeholder.

Now, the template is as follows:
------------------
TEMPLATE STARTS
------------------
[1. Opening Statement]
The introduction should commence with a broad yet detailed statement about the field of study. It's essential to set the stage for the research, making it engaging and accessible for a general scientific audience while retaining technical accuracy. This part is the first half of the opening paragraph.

[2. Importance of the Field]
The second half of the opening paragraph should emphasize the importance and relevance of the field. It's crucial to highlight the potential impact of the research area, its significance in advancing scientific knowledge, and its applications in real-world scenarios.

[3. Existing Knowledge and Gaps]
In the next 1-2 paragraphs, provide a comprehensive summary of the current state of knowledge in the field. This section should identify key gaps or unanswered questions in the existing research, using precise data and measurements where relevant. It sets up the context and necessity for your research, outlining why your study is both timely and important.

[4. Limitations in Previous Works]
In the next 1-2 paragraphs, this section should critically examine the limitations inherent in previous research within the field. Discuss methodological constraints, such as the use of specific models (e.g., animal models in neuroscience) or tools (like imaging techniques), which may have restricted the scope or applicability of the findings. Additionally, address any logical shortcomings or gaps in previous studies, such as unexplored variables, overlooked correlations, or assumptions that may have influenced the outcomes. Highlighting these limitations not only sets the stage for your research contribution but also contextualizes your work within the broader field, establishing the necessity for your approach and methodology.

[5. Research Question or Hypothesis]
Dedicate one paragraph to clearly stating the research question or hypothesis of your study. This should be specific, directly related to the gaps identified, and framed in a way that highlights its significance in the broader context of the field.

[6. Approach and Methods]
Describe the approach and methods used in your research, in one paragraph. This section should give an overview of the methods without delving into excessive detail, but maintain enough technicality to be clear and credible to a scientifically literate audience. Also, highlight the speriority of current study over existing works mensioned in the [3. Limitations in Previous Work].

[7. Overview of Results]
Optionally, include a paragraph providing a high-level summary of the main findings of your research. This should avoid detailed data but effectively convey the overall outcomes and achievements of the study.

[8. Significance and Implications]
Conclude with a separate, final paragraph of 1-3 sentences discussing the significance of your findings and their implications for the field. It should articulate how your research contributes to advancing knowledge and what it potentially means for future studies in the field.
----------------
TEMPLATE ENDS
----------------

For example, the introduction below is well-written, following the provided template.

----------------
EXAMPLE STARTS
----------------
[START of 1. Opening Statement] Dementia, which affects an estimated 50 million people worldwide, is a significant health challenge characterized by the progressive decline of memory, attention, and executive functions, which are pivotal for maintaining daily independence (Prince et al., 2015). [END of 1. Opening Statement] [START of 2. Importance of the Field] Accurate identification of its various subtypes, such as Alzheimer's disease (AD), dementia with Lewy bodies (DLB), and idiopathic normal-pressure hydrocephalus (iNPH), is crucial for appropriate clinical management (Barker et al., 2002; Williams and Malm, 2016; McKeith et al., 2017; Arvanitakis et al., 2019; Leuzy et al., 2022). [END of 2. Importance of the Field]

[START of 4. Limitations in Previous Works] The pursuit of early and precise differentiation of dementia subtypes is hindered by several factors. Traditional diagnostic techniques, such as magnetic resonance imaging (MRI), positron emission tomography (PET), and cerebrospinal fluid (CSF) tests, while effective, are costly, invasive, and not universally accessible, limiting their utility in certain regions (Garn et al., 2017; Hata et al., 2023). Moreover, the mild cognitive impairment (MCI) stage, often a precursor to dementia, presents a diagnostic challenge due to its subtle symptom presentation, complicating its diagnosis in clinical practice (Ieracitano et al., 2020). [END of 4. Limitations in Previous Works]

[START of 5. Research Question or Hypothesis] These issues underscore the necessity for a more accessible, noninvasive, and standardized screening tool capable of discerning the nuanced differences between dementia subtypes. [END of 5. Research Question or Hypothesis]

[START of 3. Existing Knowledge and Gaps] Further highlighting the urgency for early and accurate diagnosis, the recent identification of an antibody targeting amyloid beta protofibrils opens a promising avenue for decelerating the progression of AD in its nascent stages (Swanson et al., 2021). Furthermore, iNPH presents a unique case wherein early detection could lead to significant symptom relief through interventions such as CSF shunting, emphasizing the importance of precise early diagnostic techniques (Williams & Malm, 2016). [END of 3. Existing Knowledge and Gaps]

[Start of 6. Approach and Methods] Responding to the need for noninvasive, cost-effective, and widely available diagnostic methods, our research has pivoted toward the utilization of electroencephalography (EEG). This neurophysiological recording technique, renowned for its noninvasiveness and cost-effectiveness, holds untapped potential for enhancing the early detection and differentiation of dementia. [END of 6. Approach and Methods]

[START of 3. Existing Knowledge and Gaps] The EEG methods proposed by existing studies, however, have often been less successful in practical application due to limited comparative analyses being available in the literature, misapplication of machine learning techniques, e.g., the failure to appropriately segregate datasets from external institutions for independent testing compromises the assessment of a model's true classification accuracy across various clinical settings, and a dearth of generalizable findings (Rossini et al., 2008; Aoki et al., 2015; Bonanni et al., 2016; Ieracitano et al., 2020; Chatzikonstantinou et al., 2021; Sánchez-Reyes et al., 2021; Micchia et al., 2022). [END of 3. Existing Knowledge and Gaps]

[START of 6. Approach and Methods] A particularly promising yet underexplored domain is the use of deep convolutional neural networks (DCNNs) with EEG data for dementia classification; notably, this technique may bypass the intricacies of feature engineering and reveal the nuanced patterns indicative of various dementia subtypes. [END of 6. Approach and Methods]

In this study, we are committed to testing three pivotal hypotheses, each aimed at overcoming the challenges of early diagnosis of dementia and its diverse subtypes. Our first hypothesis contends that the proposed DCNN using EEG data can accurately distinguish between healthy volunteers (HVs) and patients with dementia across multiple institutions; verifying this hypothesis would indicate the robustness and wide applicability of our model. Our second hypothesis posits that this EEG-driven DCNN will be able to adeptly classify dementia subtypes (AD, DLB, or iNPH); evidence in support of this hypothesis would showcase the model's diagnostic precision. Last, our third hypothesis is that identifiable EEG patterns associated with dementia subtypes are anticipated to be present in the preceding MCI stages; if this is the case, it would suggest the existence of potential indicators that may provide insights into the progression from MCI to overt dementia. Our findings could mark a significant advancement in predictive diagnostics and tailor-made therapeutic interventions in the realm of neurodegenerative diseases.
----------------
EXAMPLE ENDS
----------------

Remember to insert the following section tags (START and END ) in the same manner as the above example:
([START of 1. Opening Statement], [END of 1. Opening Statement], [START of 2. Importance of the Field], [END of 2. Importance of the Field], [START of 3. Existing Knowledge and Gaps], [END of 3. Existing Knowledge and Gaps], [START of 4. Limitations in Previous Works], [END of 4. Limitations in Previous Works], [START of 5. Research Question or Hypothesis], [END of 5. Research Question or Hypothesis], [START of 6. Approach and Methods], [END of 6. Approach and Methods], [START of 7. Overview of Results], [END of 7. Overview of Results], [START of 8. Significance and Implications], and [END of 8. Significance and Implications]).

###### Methods Rules
# Aim of Methods
The purpose of the methods section in a scientific paper is to provide a detailed account of the research process so that readers can evaluate the study's validity and reliability. The methods section also serves as a blueprint for the study, helping other researchers replicate the findings and advance scientific knowledge. 

# Rules
- Style
  - Please follow the format of the template I will provide below in this message.
  - Your revision should conform to the language style typical of a scholarly article in biology.
  - Use technical language suitable for neuroscience journals 
  - Spell out abbreviations and acronyms in their first appearance
  - Include a clear, concise topic sentence in each paragraph.
  - Use transition phrases between paragraphs to make introduction coherent and cohesive
  - Insert a newline with the tab identation between pargraphs, except for between the first and second paragraphs;both [1. Opening Statement] and [2. Importance of the Field] sections should be in the first paragraph.

- Volume
  - Ensure to write at least 1000 words

- Misc.
  - Explicitly indicate species with sample sizes
  - Add relevant references when applicable
  - Keep existing references as they are
  - Maintain quantitative measurements as they are written.
  - Target audience is neuroscience/psychology specialists
  - Pay careful attention to the use of hyphens, en dashes, em dashes, and minus signs.
  - Avoid unnercessary adjectives for emphasizing like "significantly", "well", 
  - If tex tags are inserted, please conform to the latex style.

- For convenience in selection, Return as pseudo code block with triplet indicator like this:
  \`\`\` sciwrite-methods
  YOUR REVISION
  \`\`\`

- Methods should be written with a focus on reproducible procedures. 
- Unnecessary expressions should be avoided. 
- Passive sentences should be used to indicate that the study can be reproduced by anyone.
- Use LaTeX format
- When adding references (to literature, tables, or figures) will enhance the quality of the paper, please insert a placeholder using this LaTeX command `\hlref{XXX}`. This command will highlight any unlinked content so that it will work well as a placeholder.


Now, the template is as follows:
------------------
TEMPLATE STARTS
------------------
(Now, I am preparing template.)
----------------
TEMPLATE ENDS
----------------

For example, the methods below is well-written, following the provided template.

----------------
EXAMPLE STARTS
----------------
(Now, I am preparing example.)
----------------
EXAMPLE ENDS
----------------

<!-- EOF -->